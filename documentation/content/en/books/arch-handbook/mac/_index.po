# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR The FreeBSD Project
# This file is distributed under the same license as the FreeBSD Documentation package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: FreeBSD Documentation VERSION\n"
"POT-Creation-Date: 2023-05-21 14:43-0300\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: Title =
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:18
#, no-wrap
msgid "The TrustedBSD MAC Framework"
msgstr ""

#. type: YAML Front Matter: title
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1
#, no-wrap
msgid "Chapter 6. The TrustedBSD MAC Framework"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:56
#, no-wrap
msgid "MAC Documentation Copyright"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:59
msgid ""
"This documentation was developed for the FreeBSD Project by Chris Costello "
"at Safeport Network Services and Network Associates Laboratories, the "
"Security Research Division of Network Associates, Inc. under DARPA/SPAWAR "
"contract N66001-01-C-8035 (\"CBOSS\"), as part of the DARPA CHATS research "
"program."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:61
msgid ""
"Redistribution and use in source (SGML DocBook) and 'compiled' forms (SGML, "
"HTML, PDF, PostScript, RTF and so forth) with or without modification, are "
"permitted provided that the following conditions are met:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:63
msgid ""
"Redistributions of source code (SGML DocBook) must retain the above "
"copyright notice, this list of conditions and the following disclaimer as "
"the first lines of this file unmodified."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:64
msgid ""
"Redistributions in compiled form (transformed to other DTDs, converted to "
"PDF, PostScript, RTF and other formats) must reproduce the above copyright "
"notice, this list of conditions and the following disclaimer in the "
"documentation and/or other materials provided with the distribution."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:69
msgid ""
"THIS DOCUMENTATION IS PROVIDED BY THE NETWORKS ASSOCIATES TECHNOLOGY, INC "
"\"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED "
"TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR "
"PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL NETWORKS ASSOCIATES TECHNOLOGY, "
"INC BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR "
"CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF "
"SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS "
"INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN "
"CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) "
"ARISING IN ANY WAY OUT OF THE USE OF THIS DOCUMENTATION, EVEN IF ADVISED OF "
"THE POSSIBILITY OF SUCH DAMAGE."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:72
#, no-wrap
msgid "Synopsis"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:77
msgid ""
"FreeBSD includes experimental support for several mandatory access control "
"policies, as well as a framework for kernel security extensibility, the "
"TrustedBSD MAC Framework.  The MAC Framework is a pluggable access control "
"framework, permitting new security policies to be easily linked into the "
"kernel, loaded at boot, or loaded dynamically at run-time.  The framework "
"provides a variety of features to make it easier to implement new security "
"policies, including the ability to easily tag security labels (such as "
"confidentiality information) onto system objects."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:79
msgid ""
"This chapter introduces the MAC policy framework and provides documentation "
"for a sample MAC policy module."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:81
#, no-wrap
msgid "Introduction"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:87
msgid ""
"The TrustedBSD MAC framework provides a mechanism to allow the compile-time "
"or run-time extension of the kernel access control model.  New system "
"policies may be implemented as kernel modules and linked to the kernel; if "
"multiple policy modules are present, their results will be composed.  The "
"MAC Framework provides a variety of access control infrastructure services "
"to assist policy writers, including support for transient and persistent "
"policy-agnostic object security labels.  This support is currently "
"considered experimental."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:89
msgid ""
"This chapter provides information appropriate for developers of policy "
"modules, as well as potential consumers of MAC-enabled environments, to "
"learn about how the MAC Framework supports access control extension of the "
"kernel."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:91
#, no-wrap
msgid "Policy Background"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:98
msgid ""
"Mandatory Access Control (MAC), refers to a set of access control policies "
"that are mandatorily enforced on users by the operating system.  MAC "
"policies may be contrasted with Discretionary Access Control (DAC) "
"protections, by which non-administrative users may (at their discretion) "
"protect objects.  In traditional UNIX systems, DAC protections include file "
"permissions and access control lists; MAC protections include process "
"controls preventing inter-user debugging and firewalls.  A variety of MAC "
"policies have been formulated by operating system designers and security "
"researches, including the Multi-Level Security (MLS) confidentiality policy, "
"the Biba integrity policy, Role-Based Access Control (RBAC), Domain and Type "
"Enforcement (DTE), and Type Enforcement (TE).  Each model bases decisions on "
"a variety of factors, including user identity, role, and security clearance, "
"as well as security labels on objects representing concepts such as data "
"sensitivity and integrity."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:101
msgid ""
"The TrustedBSD MAC Framework is capable of supporting policy modules that "
"implement all of these policies, as well as a broad class of system "
"hardening policies, which may use existing security attributes, such as user "
"and group IDs, as well as extended attributes on files, and other system "
"properties.  In addition, despite the name, the MAC Framework can also be "
"used to implement purely discretionary policies, as policy modules are given "
"substantial flexibility in how they authorize protections."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:103
#, no-wrap
msgid "MAC Framework Kernel Architecture"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:107
msgid ""
"The TrustedBSD MAC Framework permits kernel modules to extend the operating "
"system security policy, as well as providing infrastructure functionality "
"required by many access control modules.  If multiple policies are "
"simultaneously loaded, the MAC Framework will usefully (for some definition "
"of useful) compose the results of the policies."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:109
#, no-wrap
msgid "Kernel Elements"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:112
msgid "The MAC Framework contains a number of kernel elements:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:114
msgid "Framework management interfaces"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:115
msgid "Concurrency and synchronization primitives."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:116
msgid "Policy registration"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:117
msgid "Extensible security label for kernel objects"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:118
msgid "Policy entry point composition operators"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:119
msgid "Label management primitives"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:120
msgid "Entry point API invoked by kernel services"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:121
msgid "Entry point API to policy modules"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:122
msgid ""
"Entry points implementations (policy life cycle, object life cycle/label "
"management, access control checks)."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:123
msgid "Policy-agnostic label-management system calls"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:124
msgid "`mac_syscall()` multiplex system call"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:125
msgid "Various security policies implemented as MAC policy modules"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:127
#, no-wrap
msgid "Framework Management Interfaces"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:130
msgid ""
"The TrustedBSD MAC Framework may be directly managed using sysctl's, loader "
"tunables, and system calls."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:135
msgid ""
"In most cases, sysctl's and loader tunables of the same name modify the same "
"parameters, and control behavior such as enforcement of protections relating "
"to various kernel subsystems.  In addition, if MAC debugging support is "
"compiled into the kernel, several counters will be maintained tracking label "
"allocation.  It is generally advisable that per-subsystem enforcement "
"controls not be used to control policy behavior in production environments, "
"as they broadly impact the operation of all active policies.  Instead, per-"
"policy controls should be preferred, as they provide greater granularity and "
"greater operational consistency for policy modules."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:137
msgid ""
"Loading and unloading of policy modules is performed using the system module "
"management system calls and other system interfaces, including boot loader "
"variables; policy modules will have the opportunity to influence load and "
"unload events, including preventing undesired unloading of the policy."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:139
#, no-wrap
msgid "Policy List Concurrency and Synchronization"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:146
msgid ""
"As the set of active policies may change at run-time, and the invocation of "
"entry points is non-atomic, synchronization is required to prevent loading "
"or unloading of policies while an entry point invocation is in progress, "
"freezing the set of active policies for the duration.  This is accomplished "
"by means of a framework busy count: whenever an entry point is entered, the "
"busy count is incremented; whenever it is exited, the busy count is "
"decremented.  While the busy count is elevated, policy list changes are not "
"permitted, and threads attempting to modify the policy list will sleep until "
"the list is not busy.  The busy count is protected by a mutex, and a "
"condition variable is used to wake up sleepers waiting on policy list "
"modifications.  One side effect of this synchronization model is that "
"recursion into the MAC Framework from within a policy module is permitted, "
"although not generally used."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:149
msgid ""
"Various optimizations are used to reduce the overhead of the busy count, "
"including avoiding the full cost of incrementing and decrementing if the "
"list is empty or contains only static entries (policies that are loaded "
"before the system starts, and cannot be unloaded).  A compile-time option is "
"also provided which prevents any change in the set of loaded policies at run-"
"time, which eliminates the mutex locking costs associated with supporting "
"dynamically loaded and unloaded policies as synchronization is no longer "
"required."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:151
msgid ""
"As the MAC Framework is not permitted to block in some entry points, a "
"normal sleep lock cannot be used; as a result, it is possible for the load "
"or unload attempt to block for a substantial period of time waiting for the "
"framework to become idle."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:153
#, no-wrap
msgid "Label Synchronization"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:160
msgid ""
"As kernel objects of interest may generally be accessed from more than one "
"thread at a time, and simultaneous entry of more than one thread into the "
"MAC Framework is permitted, security attribute storage maintained by the MAC "
"Framework is carefully synchronized.  In general, existing kernel "
"synchronization on kernel object data is used to protect MAC Framework "
"security labels on the object: for example, MAC labels on sockets are "
"protected using the existing socket mutex.  Likewise, semantics for "
"concurrent access are generally identical to those of the container objects: "
"for credentials, copy-on-write semantics are maintained for label contents "
"as with the remainder of the credential structure.  The MAC Framework "
"asserts necessary locks on objects when invoked with an object reference.  "
"Policy authors must be aware of these synchronization semantics, as they "
"will sometimes limit the types of accesses permitted on labels: for example, "
"when a read-only reference to a credential is passed to a policy via an "
"entry point, only read operations are permitted on the label state attached "
"to the credential."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:162
#, no-wrap
msgid "Policy Synchronization and Concurrency"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:168
msgid ""
"Policy modules must be written to assume that many kernel threads may "
"simultaneously enter one more policy entry points due to the parallel and "
"preemptive nature of the FreeBSD kernel.  If the policy module makes use of "
"mutable state, this may require the use of synchronization primitives within "
"the policy to prevent inconsistent views on that state resulting in "
"incorrect operation of the policy.  Policies will generally be able to make "
"use of existing FreeBSD synchronization primitives for this purpose, "
"including mutexes, sleep locks, condition variables, and counting "
"semaphores.  However, policies should be written to employ these primitives "
"carefully, respecting existing kernel lock orders, and recognizing that some "
"entry points are not permitted to sleep, limiting the use of primitives in "
"those entry points to mutexes and wakeup operations."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:171
msgid ""
"When policy modules call out to other kernel subsystems, they will generally "
"need to release any in-policy locks in order to avoid violating the kernel "
"lock order or risking lock recursion.  This will maintain policy locks as "
"leaf locks in the global lock order, helping to avoid deadlock."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:173
#, no-wrap
msgid "Policy Registration"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:180
msgid ""
"The MAC Framework maintains two lists of active policies: a static list, and "
"a dynamic list.  The lists differ only with regards to their locking "
"semantics: an elevated reference count is not required to make use of the "
"static list.  When kernel modules containing MAC Framework policies are "
"loaded, the policy module will use `SYSINIT` to invoke a registration "
"function; when a policy module is unloaded, `SYSINIT` will likewise invoke a "
"de-registration function.  Registration may fail if a policy module is "
"loaded more than once, if insufficient resources are available for the "
"registration (for example, the policy might require labeling and "
"insufficient labeling state might be available), or other policy "
"prerequisites might not be met (some policies may only be loaded prior to "
"boot).  Likewise, de-registration may fail if a policy is flagged as not "
"unloadable."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:182
#, no-wrap
msgid "Entry Points"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:189
msgid ""
"Kernel services interact with the MAC Framework in two ways: they invoke a "
"series of APIs to notify the framework of relevant events, and they provide "
"a policy-agnostic label structure pointer in security-relevant objects.  The "
"label pointer is maintained by the MAC Framework via label management entry "
"points, and permits the Framework to offer a labeling service to policy "
"modules through relatively non-invasive changes to the kernel subsystem "
"maintaining the object.  For example, label pointers have been added to "
"processes, process credentials, sockets, pipes, vnodes, Mbufs, network "
"interfaces, IP reassembly queues, and a variety of other security-relevant "
"structures.  Kernel services also invoke the MAC Framework when they perform "
"important security decisions, permitting policy modules to augment those "
"decisions based on their own criteria (possibly including data stored in "
"security labels).  Most of these security critical decisions will be "
"explicit access control checks; however, some affect more general decision "
"functions such as packet matching for sockets and label transition at "
"program execution."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:191
#, no-wrap
msgid "Policy Composition"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:199
msgid ""
"When more than one policy module is loaded into the kernel at a time, the "
"results of the policy modules will be composed by the framework using a "
"composition operator.  This operator is currently hard-coded, and requires "
"that all active policies must approve a request for it to return success.  "
"As policies may return a variety of error conditions (success, access "
"denied, object does not exist, ...), a precedence operator selects the "
"resulting error from the set of errors returned by policies.  In general, "
"errors indicating that an object does not exist will be preferred to errors "
"indicating that access to an object is denied.  While it is not guaranteed "
"that the resulting composition will be useful or secure, we have found that "
"it is for many useful selections of policies.  For example, traditional "
"trusted systems often ship with two or more policies using a similar "
"composition."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:201
#, no-wrap
msgid "Labeling Support"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:207
msgid ""
"As many interesting access control extensions rely on security labels on "
"objects, the MAC Framework provides a set of policy-agnostic label "
"management system calls covering a variety of user-exposed objects.  Common "
"label types include partition identifiers, sensitivity labels, integrity "
"labels, compartments, domains, roles, and types.  By policy agnostic, we "
"mean that policy modules are able to completely define the semantics of meta-"
"data associated with an object.  Policy modules participate in the "
"internalization and externalization of string-based labels provides by user "
"applications, and can expose multiple label elements to applications if "
"desired."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:215
msgid ""
"In-memory labels are stored in slab-allocated `struct label`, which consists "
"of a fixed-length array of unions, each holding a `void *` pointer and a "
"`long`.  Policies registering for label storage will be assigned a \"slot\" "
"identifier, which may be used to dereference the label storage.  The "
"semantics of the storage are left entirely up to the policy module: modules "
"are provided with a variety of entry points associated with the kernel "
"object life cycle, including initialization, association/creation, and "
"destruction.  Using these interfaces, it is possible to implement reference "
"counting and other storage models.  Direct access to the object structure is "
"generally not required by policy modules to retrieve a label, as the MAC "
"Framework generally passes both a pointer to the object and a direct pointer "
"to the object's label into entry points.  The primary exception to this rule "
"is the process credential, which must be manually dereferenced to access the "
"credential label.  This may change in future revisions of the MAC Framework."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:222
msgid ""
"Initialization entry points frequently include a sleeping disposition flag "
"indicating whether or not an initialization is permitted to sleep; if "
"sleeping is not permitted, a failure may be returned to cancel allocation of "
"the label (and hence object).  This may occur, for example, in the network "
"stack during interrupt handling, where sleeping is not permitted, or while "
"the caller holds a mutex.  Due to the performance cost of maintaining labels "
"on in-flight network packets (Mbufs), policies must specifically declare a "
"requirement that Mbuf labels be allocated.  Dynamically loaded policies "
"making use of labels must be able to handle the case where their init "
"function has not been called on an object, as objects may already exist when "
"the policy is loaded.  The MAC Framework guarantees that uninitialized label "
"slots will hold a 0 or NULL value, which policies may use to detect "
"uninitialized values.  However, as allocation of Mbuf labels is conditional, "
"policies must also be able to handle a NULL label pointer for Mbufs if they "
"have been loaded dynamically."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:228
msgid ""
"In the case of file system labels, special support is provided for the "
"persistent storage of security labels in extended attributes.  Where "
"available, extended attribute transactions are used to permit consistent "
"compound updates of security labels on vnodes--currently this support is "
"present only in the UFS2 file system.  Policy authors may choose to "
"implement multilabel file system object labels using one (or more) extended "
"attributes.  For efficiency reasons, the vnode label (`v_label`) is a cache "
"of any on-disk label; policies are able to load values into the cache when "
"the vnode is instantiated, and update the cache as needed.  As a result, the "
"extended attribute need not be directly accessed with every access control "
"check."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:232
msgid ""
"Currently, if a labeled policy permits dynamic unloading, its state slot "
"cannot be reclaimed, which places a strict (and relatively low) bound on the "
"number of unload-reload operations for labeled policies."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:235
#, no-wrap
msgid "System Calls"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:238
msgid ""
"The MAC Framework implements a number of system calls: most of these calls "
"support the policy-agnostic label retrieval and manipulation APIs exposed to "
"user applications."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:244
msgid ""
"The label management calls accept a label description structure, `struct "
"mac`, which contains a series of MAC label elements.  Each element contains "
"a character string name, and character string value.  Each policy will be "
"given the chance to claim a particular element name, permitting policies to "
"expose multiple independent elements if desired.  Policy modules perform the "
"internalization and externalization between kernel labels and user-provided "
"labels via entry points, permitting a variety of semantics.  Label "
"management system calls are generally wrapped by user library functions to "
"perform memory allocation and error handling, simplifying user applications "
"that must manage labels."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:246
msgid ""
"The following MAC-related system calls are present in the FreeBSD kernel:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:248
msgid ""
"`mac_get_proc()` may be used to retrieve the label of the current process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:249
msgid ""
"`mac_set_proc()` may be used to request a change in the label of the current "
"process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:250
msgid ""
"`mac_get_fd()` may be used to retrieve the label of an object (file, socket, "
"pipe, ...) referenced by a file descriptor."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:251
msgid ""
"`mac_get_file()` may be used to retrieve the label of an object referenced "
"by a file system path."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:252
msgid ""
"`mac_set_fd()` may be used to request a change in the label of an object "
"(file, socket, pipe, ...) referenced by a file descriptor."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:253
msgid ""
"`mac_set_file()` may be used to request a change in the label of an object "
"referenced by a file system path."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:254
msgid ""
"`mac_syscall()` permits policy modules to create new system calls without "
"modifying the system call table; it accepts a target policy name, operation "
"number, and opaque argument for use by the policy."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:255
msgid ""
"`mac_get_pid()` may be used to request the label of another process by "
"process id."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:256
msgid ""
"`mac_get_link()` is identical to `mac_get_file()`, only it will not follow a "
"symbolic link if it is the final entry in the path, so may be used to "
"retrieve the label on a symlink."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:257
msgid ""
"`mac_set_link()` is identical to `mac_set_file()`, only it will not follow a "
"symbolic link if it is the final entry in a path, so may be used to "
"manipulate the label on a symlink."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:259
msgid ""
"`mac_execve()` is identical to the `execve()` system call, only it also "
"accepts a requested label to set the process label to when beginning "
"execution of a new program.  This change in label on execution is referred "
"to as a \"transition\"."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:260
msgid ""
"`mac_get_peer()`, actually implemented via a socket option, retrieves the "
"label of a remote peer on a socket, if available."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:262
msgid ""
"In addition to these system calls, the `SIOCSIGMAC` and `SIOCSIFMAC` network "
"interface ioctls permit the labels on network interfaces to be retrieved and "
"set."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:264
#, no-wrap
msgid "MAC Policy Architecture"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:269
msgid ""
"Security policies are either linked directly into the kernel, or compiled "
"into loadable kernel modules that may be loaded at boot, or dynamically "
"using the module loading system calls at runtime.  Policy modules interact "
"with the system through a set of declared entry points, providing access to "
"a stream of system events and permitting the policy to influence access "
"control decisions.  Each policy contains a number of elements:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:271
msgid "Optional configuration parameters for policy."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:272
msgid "Centralized implementation of the policy logic and parameters."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:273
msgid ""
"Optional implementation of policy life cycle events, such as initialization "
"and destruction."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:274
msgid ""
"Optional support for initializing, maintaining, and destroying labels on "
"selected kernel objects."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:275
msgid ""
"Optional support for user process inspection and modification of labels on "
"selected objects."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:276
msgid ""
"Implementation of selected access control entry points that are of interest "
"to the policy."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:277
msgid ""
"Declaration of policy identity, module entry points, and policy properties."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:279
#, no-wrap
msgid "Policy Declaration"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:282
msgid ""
"Modules may be declared using the `MAC_POLICY_SET()` macro, which names the "
"policy, provides a reference to the MAC entry point vector, provides load-"
"time flags determining how the policy framework should handle the policy, "
"and optionally requests the allocation of label state by the framework."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:296
#, no-wrap
msgid ""
"static struct mac_policy_ops mac_policy_ops =\n"
"{\n"
"        .mpo_destroy = mac_policy_destroy,\n"
"        .mpo_init = mac_policy_init,\n"
"        .mpo_init_bpfdesc_label = mac_policy_init_bpfdesc_label,\n"
"        .mpo_init_cred_label = mac_policy_init_label,\n"
"/* ... */\n"
"        .mpo_check_vnode_setutimes = mac_policy_check_vnode_setutimes,\n"
"        .mpo_check_vnode_stat = mac_policy_check_vnode_stat,\n"
"        .mpo_check_vnode_write = mac_policy_check_vnode_write,\n"
"};\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:301
msgid ""
"The MAC policy entry point vector, `mac__policy__ops` in this example, "
"associates functions defined in the module with specific entry points.  A "
"complete listing of available entry points and their prototypes may be found "
"in the MAC entry point reference section.  Of specific interest during "
"module registration are the .mpo_destroy and .mpo_init entry points."
msgstr ""

#. type: Block title
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:301
#, no-wrap
msgid "mpo_init will be invoked once a policy is successfully registered with the module framework but prior to any other entry points becoming active."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:303
msgid ""
"This permits the policy to perform any policy-specific allocation and "
"initialization, such as initialization of any data or locks."
msgstr ""

#. type: Block title
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:303
#, no-wrap
msgid "mpo_destroy will be invoked when a policy module is unloaded to permit releasing of any allocated memory and destruction of locks."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:305
msgid ""
"Currently, these two entry points are invoked with the MAC policy list mutex "
"held to prevent any other entry points from being invoked: this will be "
"changed, but in the mean time, policies should be careful about what kernel "
"primitives they invoke so as to avoid lock ordering or sleeping problems."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:309
msgid ""
"The policy declaration's module name field exists so that the module may be "
"uniquely identified for the purposes of module dependencies.  An appropriate "
"string should be selected.  The full string name of the policy is displayed "
"to the user via the kernel log during load and unload events, and also "
"exported when providing status information to userland processes."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:311
#, no-wrap
msgid "Policy Flags"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:315
msgid ""
"The policy declaration flags field permits the module to provide the "
"framework with information about its capabilities at the time the module is "
"loaded.  Currently, three flags are defined:"
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:316
#, no-wrap
msgid "MPC_LOADTIME_FLAG_UNLOADOK"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:320
msgid ""
"This flag indicates that the policy module may be unloaded.  If this flag is "
"not provided, then the policy framework will reject requests to unload the "
"module.  This flag might be used by modules that allocate label state and "
"are unable to free that state at runtime."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:321
#, no-wrap
msgid "MPC_LOADTIME_FLAG_NOTLATE"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:325
msgid ""
"This flag indicates that the policy module must be loaded and initialized "
"early in the boot process.  If the flag is specified, attempts to register "
"the module following boot will be rejected.  The flag may be used by "
"policies that require pervasive labeling of all system objects, and cannot "
"handle objects that have not been properly initialized by the policy."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:326
#, no-wrap
msgid "MPC_LOADTIME_FLAG_LABELMBUFS"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:331
msgid ""
"This flag indicates that the policy module requires labeling of Mbufs, and "
"that memory should always be allocated for the storage of Mbuf labels.  By "
"default, the MAC Framework will not allocate label storage for Mbufs unless "
"at least one loaded policy has this flag set.  This measurably improves "
"network performance when policies do not require Mbuf labeling.  A kernel "
"option, `MAC_ALWAYS_LABEL_MBUF`, exists to force the MAC Framework to "
"allocate Mbuf label storage regardless of the setting of this flag, and may "
"be useful in some environments."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:337
msgid ""
"Policies using the `MPC_LOADTIME_FLAG_LABELMBUFS` without the "
"`MPC_LOADTIME_FLAG_NOTLATE` flag set must be able to correctly handle `NULL` "
"Mbuf label pointers passed into entry points.  This is necessary as in-"
"flight Mbufs without label storage may persist after a policy enabling Mbuf "
"labeling has been loaded.  If a policy is loaded before the network "
"subsystem is active (i.e., the policy is not being loaded late), then all "
"Mbufs are guaranteed to have label storage."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:340
#, no-wrap
msgid "Policy Entry Points"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:344
msgid ""
"Four classes of entry points are offered to policies registered with the "
"framework: entry points associated with the registration and management of "
"policies, entry points denoting initialization, creation, destruction, and "
"other life cycle events for kernel objects, events associated with access "
"control decisions that the policy module may influence, and calls associated "
"with the management of labels on objects.  In addition, a `mac_syscall()` "
"entry point is provided so that policies may extend the kernel interface "
"without registering new system calls."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:349
msgid ""
"Policy module writers should be aware of the kernel locking strategy, as "
"well as what object locks are available during which entry points.  Writers "
"should attempt to avoid deadlock scenarios by avoiding grabbing non-leaf "
"locks inside of entry points, and also follow the locking protocol for "
"object access and modification.  In particular, writers should be aware that "
"while necessary locks to access objects and their labels are generally held, "
"sufficient locks to modify an object or its label may not be present for all "
"entry points.  Locking information for arguments is documented in the MAC "
"framework entry point document."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:353
msgid ""
"Policy entry points will pass a reference to the object label along with the "
"object itself.  This permits labeled policies to be unaware of the internals "
"of the object yet still make decisions based on the label.  The exception to "
"this is the process credential, which is assumed to be understood by "
"policies as a first class security object in the kernel."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:355
#, no-wrap
msgid "MAC Policy Entry Point Reference"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:358
#, no-wrap
msgid "General-Purpose Module Entry Points"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:361
#, no-wrap
msgid "`mpo_init`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:367
#, no-wrap
msgid ""
"void mpo_init(\tconf);\n"
"struct mac_policy_conf *conf;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:373
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:398
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:426
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:465
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:495
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:519
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:543
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:567
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:593
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:625
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:657
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:685
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:709
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:735
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:765
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:793
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:817
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:841
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:865
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:889
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:913
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:937
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:961
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:985
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1011
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1039
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1063
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1087
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1111
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1135
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1161
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1190
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1219
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1252
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1298
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1344
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1390
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1436
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1482
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1528
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1571
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1614
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1657
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1700
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1794
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1843
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1887
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1926
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1964
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2006
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2063
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2122
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2164
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2192
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2233
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2275
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2322
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2362
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2398
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2436
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2477
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2518
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2559
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2601
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2644
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2678
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2712
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2753
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2794
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2835
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2877
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2919
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2961
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3006
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3056
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3098
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3142
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3183
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3223
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3259
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3301
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3334
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3357
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3382
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3448
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3484
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3509
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3538
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3567
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3598
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3629
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3652
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3683
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3726
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3761
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3798
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3837
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3872
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3909
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3948
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3989
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4024
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4057
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4091
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4126
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4167
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4204
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4237
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4276
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4312
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4348
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4390
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4427
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4466
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4518
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4571
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4612
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4652
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4699
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4755
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4804
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4845
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4886
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4923
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4968
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5023
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5075
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5114
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5157
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5198
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5235
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5273
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5314
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5365
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5419
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5462
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5507
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5557
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5600
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5635
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5672
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5715
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5764
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5809
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5846
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5877
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5902
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5929
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5956
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6001
#, no-wrap
msgid "Parameter"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:374
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:399
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:427
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:466
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:496
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:520
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:544
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:568
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:594
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:626
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:658
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:686
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:710
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:736
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:766
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:794
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:818
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:842
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:866
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:890
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:914
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:938
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:962
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:986
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1012
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1040
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1064
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1088
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1112
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1136
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1162
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1191
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1220
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1253
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1299
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1345
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1391
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1437
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1483
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1529
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1572
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1615
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1658
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1701
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1795
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1844
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1888
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1927
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1965
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2007
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2064
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2123
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2165
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2193
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2234
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2276
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2323
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2363
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2399
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2437
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2478
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2519
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2560
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2602
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2645
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2679
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2713
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2754
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2795
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2836
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2878
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2920
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2962
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3007
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3057
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3099
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3143
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3184
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3224
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3260
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3302
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3335
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3358
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3383
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3449
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3485
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3510
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3539
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3568
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3599
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3630
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3653
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3684
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3727
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3762
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3799
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3838
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3873
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3910
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3949
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3990
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4025
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4058
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4092
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4127
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4168
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4205
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4238
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4277
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4313
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4349
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4391
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4428
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4467
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4519
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4572
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4613
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4653
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4700
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4756
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4805
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4846
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4887
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4924
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4969
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5024
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5076
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5115
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5158
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5199
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5236
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5274
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5315
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5366
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5420
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5463
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5508
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5558
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5601
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5636
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5673
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5716
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5765
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5810
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5847
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5878
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5903
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5930
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5957
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6002
#, no-wrap
msgid "Description"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:376
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:401
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:429
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:468
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:498
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:522
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:546
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:570
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:596
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:628
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:660
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:688
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:712
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:738
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:768
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:796
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:820
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:844
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:868
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:892
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:916
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:940
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:964
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:988
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1014
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1042
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1066
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1090
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1114
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1138
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1164
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1193
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1222
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1255
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1301
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1347
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1393
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1439
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1485
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1531
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1574
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1617
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1660
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1703
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1797
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1846
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1890
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1929
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1967
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2009
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2066
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2125
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2167
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2195
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2236
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2278
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2325
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2365
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2401
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2439
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2480
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2521
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2562
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2604
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2647
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2681
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2715
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2756
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2797
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2838
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2880
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2922
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2964
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3009
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3059
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3101
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3145
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3186
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3226
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3262
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3304
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3337
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3360
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3385
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3451
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3487
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3512
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3541
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3570
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3601
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3632
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3655
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3686
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3729
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3764
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3801
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3840
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3875
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3912
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3951
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3992
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4027
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4060
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4094
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4129
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4170
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4207
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4240
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4279
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4315
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4351
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4393
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4430
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4469
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4521
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4574
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4615
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4655
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4702
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4758
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4807
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4848
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4889
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4926
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4971
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5026
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5078
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5117
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5160
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5201
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5238
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5276
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5317
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5368
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5422
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5465
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5510
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5560
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5603
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5638
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5675
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5718
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5767
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5812
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5849
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5880
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5905
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5932
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5959
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6004
#, no-wrap
msgid "Locking"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:377
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:402
#, no-wrap
msgid "`conf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:378
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:403
#, no-wrap
msgid "MAC policy definition"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:384
msgid ""
"Policy load event.  The policy list mutex is held, so sleep operations "
"cannot be performed, and calls out to other kernel subsystems must be made "
"with caution.  If potentially sleeping memory allocations are required "
"during policy initialization, they should be made using a separate module "
"SYSINIT()."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:386
#, no-wrap
msgid "`mpo_destroy`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:392
#, no-wrap
msgid ""
"void mpo_destroy(\tconf);\n"
"struct mac_policy_conf *conf;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:408
msgid ""
"Policy load event.  The policy list mutex is held, so caution should be "
"applied."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:410
#, no-wrap
msgid "`mpo_syscall`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:420
#, no-wrap
msgid ""
"int mpo_syscall(\ttd,\n"
" \tcall,\n"
" \targ);\n"
"struct thread *td;\n"
"int call;\n"
"void *arg;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:430
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:469
#, no-wrap
msgid "`td`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:431
#, no-wrap
msgid "Calling thread"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:434
#, no-wrap
msgid "`call`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:435
#, no-wrap
msgid "Policy-specific syscall number"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:438
#, no-wrap
msgid "`arg`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:439
#, no-wrap
msgid "Pointer to syscall arguments"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:446
msgid ""
"This entry point provides a policy-multiplexed system call so that policies "
"may provide additional services to user processes without registering "
"specific system calls.  The policy name provided during registration is used "
"to demultiplexer calls from userland, and the arguments will be forwarded to "
"this entry point.  When implementing new services, security modules should "
"be sure to invoke appropriate access control checks from the MAC framework "
"as needed.  For example, if a policy implements an augmented signal "
"functionality, it should call the necessary signal access control checks to "
"invoke the MAC framework and other registered policies."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:450
msgid ""
"Modules must currently perform the `copyin()` of the syscall data on their "
"own."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:453
#, no-wrap
msgid "`mpo_thread_userret`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:459
#, no-wrap
msgid ""
"void mpo_thread_userret(\ttd);\n"
"struct thread *td;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:470
#, no-wrap
msgid "Returning thread"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:478
msgid ""
"This entry point permits policy modules to perform MAC-related events when a "
"thread returns to user space, via a system call return, trap return, or "
"otherwise.  This is required for policies that have floating process labels, "
"as it is not always possible to acquire the process lock at arbitrary points "
"in the stack during system call processing; process labels might represent "
"traditional authentication data, process history information, or other "
"data.  To employ this mechanism, intended changes to the process credential "
"label may be stored in the `p_label` protected by a per-policy spin lock, "
"and then set the per-thread `TDF_ASTPENDING` flag and per-process "
"`PS_MACPENDM` flag to schedule a call to the `userret` entry point.  From "
"this entry point, the policy may create a replacement credential with less "
"concern about the locking context.  Policy writers are cautioned that event "
"ordering relating to scheduling an AST and the AST being performed may be "
"complex and interlaced in multithreaded applications."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:480
#, no-wrap
msgid "Label Operations"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:483
#, no-wrap
msgid "`mpo_init_bpfdesc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:489
#, no-wrap
msgid ""
"void mpo_init_bpfdesc_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:499
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:523
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:547
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:571
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:597
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:633
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:689
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:713
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:739
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:769
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:797
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:821
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:845
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:869
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:893
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:917
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:941
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:965
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:989
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1043
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1091
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1115
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1139
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1256
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1302
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1348
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1394
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1440
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1486
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1532
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1575
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1618
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1661
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1704
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1938
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2075
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4360
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4538
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4583
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4624
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4664
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4711
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4775
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4816
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4857
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4939
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4988
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5043
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5169
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5247
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5285
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5326
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5377
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5431
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5474
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5519
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5569
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5684
#, no-wrap
msgid "`label`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:500
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:548
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:572
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:598
#, no-wrap
msgid "New label to apply"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:505
msgid ""
"Initialize the label on a newly instantiated bpfdesc (BPF descriptor).  "
"Sleeping is permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:507
#, no-wrap
msgid "`mpo_init_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:513
#, no-wrap
msgid ""
"void mpo_init_cred_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:524
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:740
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:770
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:798
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:822
#, no-wrap
msgid "New label to initialize"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:529
msgid ""
"Initialize the label for a newly instantiated user credential.  Sleeping is "
"permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:531
#, no-wrap
msgid "`mpo_init_devfsdirent_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:537
#, no-wrap
msgid ""
"void mpo_init_devfsdirent_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:553
msgid ""
"Initialize the label on a newly instantiated devfs entry.  Sleeping is "
"permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:555
#, no-wrap
msgid "`mpo_init_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:561
#, no-wrap
msgid ""
"void mpo_init_ifnet_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:577
msgid ""
"Initialize the label on a newly instantiated network interface.  Sleeping is "
"permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:579
#, no-wrap
msgid "`mpo_init_ipq_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:587
#, no-wrap
msgid ""
"void mpo_init_ipq_label(\tlabel,\n"
" \tflag);\n"
"struct label *label;\n"
"int flag;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:601
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:629
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:743
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:773
#, no-wrap
msgid "`flag`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:602
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:630
#, no-wrap
msgid "Sleeping/non-sleeping man:malloc[9]; see below"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:609
msgid ""
"Initialize the label on a newly instantiated IP fragment reassembly queue.  "
"The `flag` field may be one of M_WAITOK and M_NOWAIT, and should be employed "
"to avoid performing a sleeping man:malloc[9] during this initialization "
"call.  IP fragment reassembly queue allocation frequently occurs in "
"performance sensitive environments, and the implementation should be careful "
"to avoid sleeping or long-lived operations.  This entry point is permitted "
"to fail resulting in the failure to allocate the IP fragment reassembly "
"queue."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:611
#, no-wrap
msgid "`mpo_init_mbuf_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:619
#, no-wrap
msgid ""
"void mpo_init_mbuf_label(\tflag,\n"
" \tlabel);\n"
"int flag;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:634
#, no-wrap
msgid "Policy label to initialize"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:641
msgid ""
"Initialize the label on a newly instantiated mbuf packet header (`mbuf`).  "
"The `flag` field may be one of M_WAITOK and M_NOWAIT, and should be employed "
"to avoid performing a sleeping man:malloc[9] during this initialization "
"call.  Mbuf allocation frequently occurs in performance sensitive "
"environments, and the implementation should be careful to avoid sleeping or "
"long-lived operations.  This entry point is permitted to fail resulting in "
"the failure to allocate the mbuf header."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:643
#, no-wrap
msgid "`mpo_init_mount_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:651
#, no-wrap
msgid ""
"void mpo_init_mount_label(\tmntlabel,\n"
" \tfslabel);\n"
"struct label *mntlabel;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:661
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1015
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2134
#, no-wrap
msgid "`mntlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:662
#, no-wrap
msgid "Policy label to be initialized for the mount itself"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:665
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1019
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1802
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1851
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1895
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2138
#, no-wrap
msgid "`fslabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:666
#, no-wrap
msgid "Policy label to be initialized for the file system"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:671
msgid ""
"Initialize the labels on a newly instantiated mount point.  Sleeping is "
"permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:673
#, no-wrap
msgid "`mpo_init_mount_fs_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:679
#, no-wrap
msgid ""
"void mpo_init_mount_fs_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:690
#, no-wrap
msgid "Label to be initialized"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:695
msgid ""
"Initialize the label on a newly mounted file system.  Sleeping is permitted"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:697
#, no-wrap
msgid "`mpo_init_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:703
#, no-wrap
msgid ""
"void mpo_init_pipe_label(\tlabel);\n"
"struct label*label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:714
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1533
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1576
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1619
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1662
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1705
#, no-wrap
msgid "Label to be filled in"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:719
msgid ""
"Initialize a label for a newly instantiated pipe.  Sleeping is permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:721
#, no-wrap
msgid "`mpo_init_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:729
#, no-wrap
msgid ""
"void mpo_init_socket_label(\tlabel,\n"
" \tflag);\n"
"struct label *label;\n"
"int flag;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:744
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:774
#, no-wrap
msgid "man:malloc[9] flags"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:749
msgid ""
"Initialize a label for a newly instantiated socket.  The `flag` field may be "
"one of M_WAITOK and M_NOWAIT, and should be employed to avoid performing a "
"sleeping man:malloc[9] during this initialization call."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:751
#, no-wrap
msgid "`mpo_init_socket_peer_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:759
#, no-wrap
msgid ""
"void mpo_init_socket_peer_label(\tlabel,\n"
" \tflag);\n"
"struct label *label;\n"
"int flag;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:779
msgid ""
"Initialize the peer label for a newly instantiated socket.  The `flag` field "
"may be one of M_WAITOK and M_NOWAIT, and should be employed to avoid "
"performing a sleeping man:malloc[9] during this initialization call."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:781
#, no-wrap
msgid "`mpo_init_proc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:787
#, no-wrap
msgid ""
"void mpo_init_proc_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:803
msgid ""
"Initialize the label for a newly instantiated process.  Sleeping is "
"permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:805
#, no-wrap
msgid "`mpo_init_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:811
#, no-wrap
msgid ""
"void mpo_init_vnode_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:827
msgid ""
"Initialize the label on a newly instantiated vnode.  Sleeping is permitted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:829
#, no-wrap
msgid "`mpo_destroy_bpfdesc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:835
#, no-wrap
msgid ""
"void mpo_destroy_bpfdesc_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:846
#, no-wrap
msgid "bpfdesc label"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:851
msgid ""
"Destroy the label on a BPF descriptor.  In this entry point a policy should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:853
#, no-wrap
msgid "`mpo_destroy_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:859
#, no-wrap
msgid ""
"void mpo_destroy_cred_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:870
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:894
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:918
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:942
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:966
#, no-wrap
msgid "Label being destroyed"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:875
msgid ""
"Destroy the label on a credential.  In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:877
#, no-wrap
msgid "`mpo_destroy_devfsdirent_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:883
#, no-wrap
msgid ""
"void mpo_destroy_devfsdirent_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:899
msgid ""
"Destroy the label on a devfs entry.  In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:901
#, no-wrap
msgid "`mpo_destroy_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:907
#, no-wrap
msgid ""
"void mpo_destroy_ifnet_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:923
msgid ""
"Destroy the label on a removed interface.  In this entry point, a policy "
"module should free any internal storage associated with `label` so that it "
"may be destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:925
#, no-wrap
msgid "`mpo_destroy_ipq_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:931
#, no-wrap
msgid ""
"void mpo_destroy_ipq_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:947
msgid ""
"Destroy the label on an IP fragment queue.  In this entry point, a policy "
"module should free any internal storage associated with `label` so that it "
"may be destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:949
#, no-wrap
msgid "`mpo_destroy_mbuf_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:955
#, no-wrap
msgid ""
"void mpo_destroy_mbuf_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:971
msgid ""
"Destroy the label on an mbuf header.  In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:973
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:997
#, no-wrap
msgid "`mpo_destroy_mount_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:979
#, no-wrap
msgid ""
"void mpo_destroy_mount_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:990
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1016
#, no-wrap
msgid "Mount point label being destroyed"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:995
msgid ""
"Destroy the labels on a mount point.  In this entry point, a policy module "
"should free the internal storage associated with `mntlabel` so that they may "
"be destroyed."
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1005
#, no-wrap
msgid ""
"void mpo_destroy_mount_label(\tmntlabel,\n"
" \tfslabel);\n"
"struct label *mntlabel;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1020
#, no-wrap
msgid "File system label being destroyed>"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1025
msgid ""
"Destroy the labels on a mount point.  In this entry point, a policy module "
"should free the internal storage associated with `mntlabel` and `fslabel` so "
"that they may be destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1027
#, no-wrap
msgid "`mpo_destroy_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1033
#, no-wrap
msgid ""
"void mpo_destroy_socket_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1044
#, no-wrap
msgid "Socket label being destroyed"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1049
msgid ""
"Destroy the label on a socket.  In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1051
#, no-wrap
msgid "`mpo_destroy_socket_peer_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1057
#, no-wrap
msgid ""
"void mpo_destroy_socket_peer_label(\tpeerlabel);\n"
"struct label *peerlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1067
#, no-wrap
msgid "`peerlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1068
#, no-wrap
msgid "Socket peer label being destroyed"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1073
msgid ""
"Destroy the peer label on a socket.  In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1075
#, no-wrap
msgid "`mpo_destroy_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1081
#, no-wrap
msgid ""
"void mpo_destroy_pipe_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1092
#, no-wrap
msgid "Pipe label"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1097
msgid ""
"Destroy the label on a pipe.  In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1099
#, no-wrap
msgid "`mpo_destroy_proc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1105
#, no-wrap
msgid ""
"void mpo_destroy_proc_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1116
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1140
#, no-wrap
msgid "Process label"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1121
msgid ""
"Destroy the label on a process.  In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1123
#, no-wrap
msgid "`mpo_destroy_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1129
#, no-wrap
msgid ""
"void mpo_destroy_vnode_label(\tlabel);\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1145
msgid ""
"Destroy the label on a vnode.  In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1147
#, no-wrap
msgid "`mpo_copy_mbuf_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1155
#, no-wrap
msgid ""
"void mpo_copy_mbuf_label(\tsrc,\n"
" \tdest);\n"
"struct label *src;\n"
"struct label *dest;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1165
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1194
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1223
#, no-wrap
msgid "`src`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1166
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1195
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1224
#, no-wrap
msgid "Source label"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1169
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1198
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1227
#, no-wrap
msgid "`dest`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1170
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1199
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1228
#, no-wrap
msgid "Destination label"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1174
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1203
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1232
msgid "Copy the label information in `src` into `dest`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1176
#, no-wrap
msgid "`mpo_copy_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1184
#, no-wrap
msgid ""
"void mpo_copy_pipe_label(\tsrc,\n"
" \tdest);\n"
"struct label *src;\n"
"struct label *dest;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1205
#, no-wrap
msgid "`mpo_copy_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1213
#, no-wrap
msgid ""
"void mpo_copy_vnode_label(\tsrc,\n"
" \tdest);\n"
"struct label *src;\n"
"struct label *dest;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1234
#, no-wrap
msgid "`mpo_externalize_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1246
#, no-wrap
msgid ""
"int mpo_externalize_cred_label(\tlabel,\n"
" \telement_name,\n"
" \tsb,\n"
" \t*claimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1257
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1303
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1349
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1395
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1441
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1487
#, no-wrap
msgid "Label to be externalized"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1260
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1306
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1352
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1398
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1444
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1490
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1536
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1579
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1622
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1665
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1708
#, no-wrap
msgid "`element_name`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1261
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1307
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1353
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1399
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1445
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1491
#, no-wrap
msgid "Name of the policy whose label should be externalized"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1264
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1310
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1356
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1402
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1448
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1494
#, no-wrap
msgid "`sb`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1265
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1311
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1357
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1403
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1449
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1495
#, no-wrap
msgid "String buffer to be filled with a text representation of label"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1268
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1314
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1360
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1406
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1452
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1498
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1544
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1587
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1630
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1673
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1716
#, no-wrap
msgid "`claimed`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1269
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1315
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1361
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1407
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1453
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1499
#, no-wrap
msgid "Should be incremented when `element_data` can be filled in."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1278
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1324
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1370
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1416
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1462
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1508
msgid ""
"Produce an externalized label based on the label structure passed.  An "
"externalized label consists of a text representation of the label contents "
"that can be used with userland applications and read by the user.  "
"Currently, all policies' `externalize` entry points will be called, so the "
"implementation should check the contents of `element_name` before attempting "
"to fill in `sb`.  If `element_name` does not match the name of your policy, "
"simply return 0.  Only return nonzero if an error occurs while externalizing "
"the label data.  Once the policy fills in `element_data`, `*claimed` should "
"be incremented."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1280
#, no-wrap
msgid "`mpo_externalize_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1292
#, no-wrap
msgid ""
"int mpo_externalize_ifnet_label(\tlabel,\n"
" \telement_name,\n"
" \tsb,\n"
" \t*claimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1326
#, no-wrap
msgid "`mpo_externalize_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1338
#, no-wrap
msgid ""
"int mpo_externalize_pipe_label(\tlabel,\n"
" \telement_name,\n"
" \tsb,\n"
" \t*claimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1372
#, no-wrap
msgid "`mpo_externalize_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1384
#, no-wrap
msgid ""
"int mpo_externalize_socket_label(\tlabel,\n"
" \telement_name,\n"
" \tsb,\n"
" \t*claimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1418
#, no-wrap
msgid "`mpo_externalize_socket_peer_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1430
#, no-wrap
msgid ""
"int mpo_externalize_socket_peer_label(\tlabel,\n"
" \telement_name,\n"
" \tsb,\n"
" \t*claimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1464
#, no-wrap
msgid "`mpo_externalize_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1476
#, no-wrap
msgid ""
"int mpo_externalize_vnode_label(\tlabel,\n"
" \telement_name,\n"
" \tsb,\n"
" \t*claimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1510
#, no-wrap
msgid "`mpo_internalize_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1522
#, no-wrap
msgid ""
"int mpo_internalize_cred_label(\tlabel,\n"
" \telement_name,\n"
" \telement_data,\n"
" \tclaimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1537
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1580
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1623
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1666
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1709
#, no-wrap
msgid "Name of the policy whose label should be internalized"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1540
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1583
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1626
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1669
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1712
#, no-wrap
msgid "`element_data`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1541
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1584
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1627
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1670
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1713
#, no-wrap
msgid "Text data to be internalized"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1545
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1588
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1631
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1674
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1717
#, no-wrap
msgid "Should be incremented when data can be successfully internalized."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1551
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1594
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1637
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1680
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1723
msgid ""
"Produce an internal label structure based on externalized label data in text "
"format.  Currently, all policies' `internalize` entry points are called when "
"internalization is requested, so the implementation should compare the "
"contents of `element_name` to its own name in order to be sure it should be "
"internalizing the data in `element_data`.  Just as in the `externalize` "
"entry points, the entry point should return 0 if `element_name` does not "
"match its own name, or when data can successfully be internalized, in which "
"case `*claimed` should be incremented."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1553
#, no-wrap
msgid "`mpo_internalize_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1565
#, no-wrap
msgid ""
"int mpo_internalize_ifnet_label(\tlabel,\n"
" \telement_name,\n"
" \telement_data,\n"
" \tclaimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1596
#, no-wrap
msgid "`mpo_internalize_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1608
#, no-wrap
msgid ""
"int mpo_internalize_pipe_label(\tlabel,\n"
" \telement_name,\n"
" \telement_data,\n"
" \tclaimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1639
#, no-wrap
msgid "`mpo_internalize_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1651
#, no-wrap
msgid ""
"int mpo_internalize_socket_label(\tlabel,\n"
" \telement_name,\n"
" \telement_data,\n"
" \tclaimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1682
#, no-wrap
msgid "`mpo_internalize_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1694
#, no-wrap
msgid ""
"int mpo_internalize_vnode_label(\tlabel,\n"
" \telement_name,\n"
" \telement_data,\n"
" \tclaimed);\n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1725
#, no-wrap
msgid "Label Events"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1733
msgid ""
"This class of entry points is used by the MAC framework to permit policies "
"to maintain label information on kernel objects.  For each labeled kernel "
"object of interest to a MAC policy, entry points may be registered for "
"relevant life cycle events.  All objects implement initialization, creation, "
"and destruction hooks.  Some objects will also implement relabeling, "
"allowing user processes to change the labels on objects.  Some objects will "
"also implement object-specific events, such as label events associated with "
"IP reassembly.  A typical labeled object will have the following life cycle "
"of entry points:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1745
#, no-wrap
msgid ""
"Label initialization          o\n"
"(object-specific wait)         \\\n"
"Label creation                  o\n"
"                                 \\\n"
"Relabel events,                   o--<--.\n"
"Various object-specific,          |     |\n"
"Access control events             ~-->--o\n"
"                                         \\\n"
"Label destruction                         o\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1749
msgid ""
"Label initialization permits policies to allocate memory and set initial "
"values for labels without context for the use of the object.  The label slot "
"allocated to a policy will be zeroed by default, so some policies may not "
"need to perform initialization."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1756
msgid ""
"Label creation occurs when the kernel structure is associated with an actual "
"kernel object.  For example, Mbufs may be allocated and remain unused in a "
"pool until they are required.  mbuf allocation causes label initialization "
"on the mbuf to take place, but mbuf creation occurs when the mbuf is "
"associated with a datagram.  Typically, context will be provided for a "
"creation event, including the circumstances of the creation, and labels of "
"other relevant objects in the creation process.  For example, when an mbuf "
"is created from a socket, the socket and its label will be presented to "
"registered policies in addition to the new mbuf and its label.  Memory "
"allocation in creation events is discouraged, as it may occur in performance "
"sensitive ports of the kernel; in addition, creation calls are not permitted "
"to fail so a failure to allocate memory cannot be reported."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1759
msgid ""
"Object specific events do not generally fall into the other broad classes of "
"label events, but will generally provide an opportunity to modify or update "
"the label on an object based on additional context.  For example, the label "
"on an IP fragment reassembly queue may be updated during the MAC_UPDATE_IPQ "
"entry point as a result of the acceptance of an additional mbuf to that "
"queue."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1761
msgid "Access control events are discussed in detail in the following section."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1763
msgid ""
"Label destruction permits policies to release storage or state associated "
"with a label during its association with an object so that the kernel data "
"structures supporting the object may be reused or released."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1767
msgid ""
"In addition to labels associated with specific kernel objects, an additional "
"class of labels exists: temporary labels.  These labels are used to store "
"update information submitted by user processes.  These labels are "
"initialized and destroyed as with other label types, but the creation event "
"is MAC_INTERNALIZE, which accepts a user label to be converted to an in-"
"kernel representation."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1769
#, no-wrap
msgid "File System Object Labeling Event Operations"
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1772
#, no-wrap
msgid "`mpo_associate_vnode_devfs`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1788
#, no-wrap
msgid ""
"void mpo_associate_vnode_devfs(\tmp,\n"
" \tfslabel,\n"
" \tde,\n"
" \tdelabel,\n"
" \tvp,\n"
" \tvlabel);\n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct devfs_dirent *de;\n"
"struct label *delabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1798
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1847
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1891
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2014
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2130
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4284
#, no-wrap
msgid "`mp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1799
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2015
#, no-wrap
msgid "Devfs mount point"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1803
#, no-wrap
msgid "Devfs file system label (`mp->mnt_fslabel`)"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1806
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2026
#, no-wrap
msgid "`de`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1807
#, no-wrap
msgid "Devfs directory entry"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1810
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2030
#, no-wrap
msgid "`delabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1811
#, no-wrap
msgid "Policy label associated with `de`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1814
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1855
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1899
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2087
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2200
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2241
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2287
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3271
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3309
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3606
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4245
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4356
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4534
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4579
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4620
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4660
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4707
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4771
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4812
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4853
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4894
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4935
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4984
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5039
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5165
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5243
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5281
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5322
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5373
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5427
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5470
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5515
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5565
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5680
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5854
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5964
#, no-wrap
msgid "`vp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1815
#, no-wrap
msgid "vnode associated with `de`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1818
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1859
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1903
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2091
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2245
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3610
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5858
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5968
#, no-wrap
msgid "`vlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1819
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1860
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1904
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2092
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2246
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4776
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4817
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4940
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4989
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5044
#, no-wrap
msgid "Policy label associated with `vp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1823
msgid ""
"Fill in the label (`vlabel`) for a newly created devfs vnode based on the "
"devfs directory entry passed in `de` and its label."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1825
#, no-wrap
msgid "`mpo_associate_vnode_extattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1837
#, no-wrap
msgid ""
"int mpo_associate_vnode_extattr(\tmp,\n"
" \tfslabel,\n"
" \tvp,\n"
" \tvlabel);\n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1848
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1892
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2072
#, no-wrap
msgid "File system mount point"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1852
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1896
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2076
#, no-wrap
msgid "File system label"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1856
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1900
#, no-wrap
msgid "Vnode to label"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1867
msgid ""
"Attempt to retrieve the label for `vp` from the file system extended "
"attributes.  Upon success, the value `0` is returned.  Should extended "
"attribute retrieval not be supported, an accepted fallback is to copy "
"`fslabel` into `vlabel`.  In the event of an error, an appropriate value for "
"`errno` should be returned."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1869
#, no-wrap
msgid "`mpo_associate_vnode_singlelabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1881
#, no-wrap
msgid ""
"void mpo_associate_vnode_singlelabel(\tmp,\n"
" \tfslabel,\n"
" \tvp,\n"
" \tvlabel);\n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1908
msgid ""
"On non-multilabel file systems, this entry point is called to set the policy "
"label for `vp` based on the file system label, `fslabel`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1910
#, no-wrap
msgid "`mpo_create_devfs_device`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1920
#, no-wrap
msgid ""
"void mpo_create_devfs_device(\tdev,\n"
" \tdevfs_dirent,\n"
" \tlabel);\n"
"dev_t dev;\n"
"struct devfs_dirent *devfs_dirent;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1930
#, no-wrap
msgid "`dev`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1931
#, no-wrap
msgid "Device corresponding with `devfs_dirent`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1934
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1976
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2279
#, no-wrap
msgid "`devfs_dirent`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1935
#, no-wrap
msgid "Devfs directory entry to be labeled."
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1939
#, no-wrap
msgid "Label for `devfs_dirent` to be filled in."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1944
msgid ""
"Fill out the label on a devfs_dirent being created for the passed device.  "
"This call will be made when the device file system is mounted, regenerated, "
"or a new device is made available."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1946
#, no-wrap
msgid "`mpo_create_devfs_directory`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1958
#, no-wrap
msgid ""
"void mpo_create_devfs_directory(\tdirname,\n"
" \tdirnamelen,\n"
" \tdevfs_dirent,\n"
" \tlabel);\n"
"char *dirname;\n"
"int dirnamelen;\n"
"struct devfs_dirent *devfs_dirent;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1968
#, no-wrap
msgid "`dirname`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1969
#, no-wrap
msgid "Name of directory being created"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1972
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6013
#, no-wrap
msgid "`namelen`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1973
#, no-wrap
msgid "Length of string `dirname`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1977
#, no-wrap
msgid "Devfs directory entry for directory being created."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1982
msgid ""
"Fill out the label on a devfs_dirent being created for the passed "
"directory.  This call will be made when the device file system is mounted, "
"regenerated, or a new device requiring a specific directory hierarchy is "
"made available."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:1984
#, no-wrap
msgid "`mpo_create_devfs_symlink`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2000
#, no-wrap
msgid ""
"void mpo_create_devfs_symlink(\tcred,\n"
" \tmp,\n"
" \tdd,\n"
" \tddlabel,\n"
" \tde,\n"
" \tdelabel);\n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct devfs_dirent *dd;\n"
"struct label *ddlabel;\n"
"struct devfs_dirent *de;\n"
"struct label *delabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2010
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2067
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2126
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2196
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2237
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2366
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2402
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2481
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2522
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2648
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3146
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3338
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3361
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3386
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3488
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3513
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3542
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3571
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3602
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3633
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3656
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3687
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3730
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3765
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3802
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3841
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3876
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3913
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3952
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3993
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4028
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4095
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4130
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4171
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4208
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4241
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4280
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4316
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4352
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4394
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4431
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4470
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4522
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4575
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4616
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4656
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4703
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4759
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4808
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4849
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4890
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4972
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5027
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5079
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5118
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5161
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5202
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5239
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5277
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5318
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5369
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5423
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5466
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5511
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5561
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5604
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5639
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5676
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5719
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5768
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5813
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5881
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5906
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5933
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5960
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6005
#, no-wrap
msgid "`cred`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2011
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2068
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2127
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2197
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2238
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2367
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2403
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2482
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2523
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2649
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3147
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3387
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3489
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3514
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3543
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3572
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3603
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3634
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3657
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3688
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3731
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3766
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3803
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3842
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3877
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3914
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3953
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3994
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4029
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4062
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4096
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4131
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4172
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4209
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4242
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4281
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4317
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4353
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4395
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4432
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4471
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4523
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4576
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4617
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4657
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4704
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4760
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4809
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4891
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4928
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4973
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5028
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5080
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5119
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5162
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5203
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5240
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5278
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5319
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5370
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5424
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5467
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5512
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5562
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5605
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5640
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5677
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5720
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5769
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5814
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5851
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5882
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5907
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5934
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5961
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6006
#, no-wrap
msgid "Subject credential"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2018
#, no-wrap
msgid "`dd`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2019
#, no-wrap
msgid "Link destination"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2022
#, no-wrap
msgid "`ddlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2023
#, no-wrap
msgid "Label associated with `dd`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2027
#, no-wrap
msgid "Symlink entry"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2031
#, no-wrap
msgid "Label associated with `de`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2035
msgid ""
"Fill in the label (`delabel`) for a newly created man:devfs[5] symbolic link "
"entry."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2037
#, no-wrap
msgid "`mpo_create_vnode_extattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2057
#, no-wrap
msgid ""
"int mpo_create_vnode_extattr(\tcred,\n"
" \tmp,\n"
" \tfslabel,\n"
" \tdvp,\n"
" \tdlabel,\n"
" \tvp,\n"
" \tvlabel,\n"
" \tcnp);\n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2071
#, no-wrap
msgid "`mount`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2079
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4398
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4435
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4474
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4526
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4763
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4976
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5031
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5122
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5206
#, no-wrap
msgid "`dvp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2080
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4527
#, no-wrap
msgid "Parent directory vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2083
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4402
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4439
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4478
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4530
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4767
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4980
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5035
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5126
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5210
#, no-wrap
msgid "`dlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2084
#, no-wrap
msgid "Label associated with `dvp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2088
#, no-wrap
msgid "Newly created vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2095
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4482
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4542
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4779
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4992
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5051
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5130
#, no-wrap
msgid "`cnp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2096
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4543
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4993
#, no-wrap
msgid "Component name for `vp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2102
msgid ""
"Write out the label for `vp` to the appropriate extended attribute.  If the "
"write succeeds, fill in `vlabel` with the label, and return 0.  Otherwise, "
"return an appropriate error."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2104
#, no-wrap
msgid "`mpo_create_mount`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2116
#, no-wrap
msgid ""
"void mpo_create_mount(\tcred,\n"
" \tmp,\n"
" \tmnt,\n"
" \tfslabel);\n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *mnt;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2131
#, no-wrap
msgid "Object; file system being mounted"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2135
#, no-wrap
msgid "Policy label to be filled in for `mp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2139
#, no-wrap
msgid "Policy label for the file system `mp` mounts."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2144
msgid ""
"Fill out the labels on the mount point being created by the passed subject "
"credential.  This call will be made when a new file system is mounted."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2146
#, no-wrap
msgid "`mpo_create_root_mount`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2158
#, no-wrap
msgid ""
"void mpo_create_root_mount(\tcred,\n"
" \tmp,\n"
" \tmntlabel,\n"
" \tfslabel);\n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *mntlabel;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2168
#, no-wrap
msgid "See <<mac-mpo-create-mount>>."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2172
msgid ""
"Fill out the labels on the mount point being created by the passed subject "
"credential.  This call will be made when the root file system is mounted, "
"after `mpo_create_mount;`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2174
#, no-wrap
msgid "`mpo_relabel_vnode`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2186
#, no-wrap
msgid ""
"void mpo_relabel_vnode(\tcred,\n"
" \tvp,\n"
" \tvnodelabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2201
#, no-wrap
msgid "vnode to relabel"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2204
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2292
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3275
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3313
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4249
#, no-wrap
msgid "`vnodelabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2205
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4250
#, no-wrap
msgid "Existing policy label for `vp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2208
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2493
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2534
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2575
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3158
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3390
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3814
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4142
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4183
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4212
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4253
#, no-wrap
msgid "`newlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2209
#, no-wrap
msgid "New, possibly partial label to replace `vnodelabel`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2213
msgid ""
"Update the label on the passed vnode given the passed update vnode label and "
"the passed subject credential."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2215
#, no-wrap
msgid "`mpo_setlabel_vnode_extattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2227
#, no-wrap
msgid ""
"int mpo_setlabel_vnode_extattr(\tcred,\n"
" \tvp,\n"
" \tvlabel,\n"
" \tintlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
"struct label *intlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2242
#, no-wrap
msgid "Vnode for which the label is being written"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2249
#, no-wrap
msgid "`intlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2250
#, no-wrap
msgid "Label to write out"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2255
msgid ""
"Write out the policy from `intlabel` to an extended attribute.  This is "
"called from `vop_stdcreatevnode_ea`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2257
#, no-wrap
msgid "`mpo_update_devfsdirent`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2269
#, no-wrap
msgid ""
"void mpo_update_devfsdirent(\tdevfs_dirent,\n"
" \tdirentlabel,\n"
" \tvp,\n"
" \tvnodelabel);\n"
"struct devfs_dirent *devfs_dirent;\n"
"struct label *direntlabel;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2280
#, no-wrap
msgid "Object; devfs directory entry"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2283
#, no-wrap
msgid "`direntlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2284
#, no-wrap
msgid "Policy label for `devfs_dirent` to be updated."
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2288
#, no-wrap
msgid "Parent vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2289
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3274
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4248
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4582
#, no-wrap
msgid "Locked"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2293
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3276
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3314
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4361
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4539
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4584
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4625
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4665
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4712
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5170
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5248
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5286
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5327
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5378
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5432
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5475
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5520
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5570
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5685
#, no-wrap
msgid "Policy label for `vp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2299
msgid ""
"Update the `devfs_dirent` label from the passed devfs vnode label.  This "
"call will be made when a devfs vnode has been successfully relabeled to "
"commit the label change such that it lasts even if the vnode is recycled.  "
"It will also be made when a symlink is created in devfs, following a call to "
"`mac_vnode_create_from_vnode` to initialize the vnode label."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2301
#, no-wrap
msgid "IPC Object Labeling Event Operations"
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2304
#, no-wrap
msgid "`mpo_create_mbuf_from_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2316
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_socket(\tso,\n"
" \tsocketlabel,\n"
" \tm,\n"
" \tmbuflabel);\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
"struct mbuf *m;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2326
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3917
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3956
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4099
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4175
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5083
#, no-wrap
msgid "`socket`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2327
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3998
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4033
#, no-wrap
msgid "Socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2329
#, no-wrap
msgid "Socket locking WIP"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2330
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2410
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3921
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3960
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4001
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4036
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4103
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4179
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5087
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5821
#, no-wrap
msgid "`socketlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2331
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3922
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3961
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4104
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5088
#, no-wrap
msgid "Policy label for `socket`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2334
#, no-wrap
msgid "`m`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2335
#, no-wrap
msgid "Object; mbuf"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2338
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2567
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2893
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2935
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2977
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3191
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5735
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5784
#, no-wrap
msgid "`mbuflabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2339
#, no-wrap
msgid "Policy label to fill in for `m`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2344
msgid ""
"Set the label on a newly created mbuf header from the passed socket label.  "
"This call is made when a new datagram or message is generated by the socket "
"and stored in the passed mbuf."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2346
#, no-wrap
msgid "`mpo_create_pipe`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2356
#, no-wrap
msgid ""
"void mpo_create_pipe(\tcred,\n"
" \tpipe,\n"
" \tpipelabel);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2370
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2485
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3691
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3734
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3769
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3806
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3845
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3880
#, no-wrap
msgid "`pipe`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2371
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2486
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3692
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3735
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3770
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3807
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3846
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3881
#, no-wrap
msgid "Pipe"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2374
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3695
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3738
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3773
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3810
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3849
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3884
#, no-wrap
msgid "`pipelabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2375
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3696
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3739
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3774
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3850
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3885
#, no-wrap
msgid "Policy label associated with `pipe`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2380
msgid ""
"Set the label on a newly created pipe from the passed subject credential.  "
"This call is made when a new pipe is created."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2382
#, no-wrap
msgid "`mpo_create_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2392
#, no-wrap
msgid ""
"void mpo_create_socket(\tcred,\n"
" \tso,\n"
" \tsocketlabel);\n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2405
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2525
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2651
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3266
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3308
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4244
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4319
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4578
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5816
#, no-wrap
msgid "Immutable"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2406
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2526
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3997
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4032
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5817
#, no-wrap
msgid "`so`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2407
#, no-wrap
msgid "Object; socket to label"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2411
#, no-wrap
msgid "Label to fill in for `so`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2416
msgid ""
"Set the label on a newly created socket from the passed subject credential.  "
"This call is made when a socket is created."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2418
#, no-wrap
msgid "`mpo_create_socket_from_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2430
#, no-wrap
msgid ""
"void mpo_create_socket_from_socket(\toldsocket,\n"
" \toldsocketlabel,\n"
" \tnewsocket,\n"
" \tnewsocketlabel);\n"
"struct socket *oldsocket;\n"
"struct label *oldsocketlabel;\n"
"struct socket *newsocket;\n"
"struct label *newsocketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2440
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2605
#, no-wrap
msgid "`oldsocket`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2441
#, no-wrap
msgid "Listening socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2444
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2609
#, no-wrap
msgid "`oldsocketlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2445
#, no-wrap
msgid "Policy label associated with `oldsocket`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2448
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2613
#, no-wrap
msgid "`newsocket`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2449
#, no-wrap
msgid "New socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2452
#, no-wrap
msgid "`newsocketlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2453
#, no-wrap
msgid "Policy label associated with `newsocketlabel`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2457
msgid ""
"Label a socket, `newsocket`, newly man:accept[2]ed, based on the man:"
"listen[2] socket, `oldsocket`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2459
#, no-wrap
msgid "`mpo_relabel_pipe`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2471
#, no-wrap
msgid ""
"void mpo_relabel_pipe(\tcred,\n"
" \tpipe,\n"
" \toldlabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *oldlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2489
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2530
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2571
#, no-wrap
msgid "`oldlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2490
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3811
#, no-wrap
msgid "Current policy label associated with `pipe`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2494
#, no-wrap
msgid "Policy label update to apply to `pipe`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2498
msgid "Apply a new label, `newlabel`, to `pipe`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2500
#, no-wrap
msgid "`mpo_relabel_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2512
#, no-wrap
msgid ""
"void mpo_relabel_socket(\tcred,\n"
" \tso,\n"
" \toldlabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *oldlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2527
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4100
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4176
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5084
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5818
#, no-wrap
msgid "Object; socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2531
#, no-wrap
msgid "Current label for `so`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2535
#, no-wrap
msgid "Label update for `so`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2539
msgid "Update the label on a socket from the passed socket label update."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2541
#, no-wrap
msgid "`mpo_set_socket_peer_from_mbuf`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2553
#, no-wrap
msgid ""
"void mpo_set_socket_peer_from_mbuf(\tmbuf,\n"
" \tmbuflabel,\n"
" \toldlabel,\n"
" \tnewlabel);\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
"struct label *oldlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2563
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2889
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2931
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2973
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3187
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5731
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5780
#, no-wrap
msgid "`mbuf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2564
#, no-wrap
msgid "First datagram received over socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2568
#, no-wrap
msgid "Label for `mbuf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2572
#, no-wrap
msgid "Current label for the socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2576
#, no-wrap
msgid "Policy label to be filled out for the socket"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2581
msgid ""
"Set the peer label on a stream socket from the passed mbuf label.  This call "
"will be made when the first datagram is received by the stream socket, with "
"the exception of Unix domain sockets."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2583
#, no-wrap
msgid "`mpo_set_socket_peer_from_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2595
#, no-wrap
msgid ""
"void mpo_set_socket_peer_from_socket(\toldsocket,\n"
" \toldsocketlabel,\n"
" \tnewsocket,\n"
" \tnewsocketpeerlabel);\n"
"struct socket *oldsocket;\n"
"struct label *oldsocketlabel;\n"
"struct socket *newsocket;\n"
"struct label *newsocketpeerlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2606
#, no-wrap
msgid "Local socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2610
#, no-wrap
msgid "Policy label for `oldsocket`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2614
#, no-wrap
msgid "Peer socket"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2617
#, no-wrap
msgid "`newsocketpeerlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2618
#, no-wrap
msgid "Policy label to fill in for `newsocket`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2623
msgid ""
"Set the peer label on a stream UNIX domain socket from the passed remote "
"socket endpoint.  This call will be made when the socket pair is connected, "
"and will be made for both endpoints."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2625
#, no-wrap
msgid "Network Object Labeling Event Operations"
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2628
#, no-wrap
msgid "`mpo_create_bpfdesc`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2638
#, no-wrap
msgid ""
"void mpo_create_bpfdesc(\tcred,\n"
" \tbpf_d,\n"
" \tbpflabel);\n"
"struct ucred *cred;\n"
"struct bpf_d *bpf_d;\n"
"struct label *bpflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2652
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2923
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3452
#, no-wrap
msgid "`bpf_d`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2653
#, no-wrap
msgid "Object; bpf descriptor"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2656
#, no-wrap
msgid "`bpf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2657
#, no-wrap
msgid "Policy label to be filled in for `bpf_d`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2662
msgid ""
"Set the label on a newly created BPF descriptor from the passed subject "
"credential.  This call will be made when a BPF device node is opened by a "
"process with the passed subject credential."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2664
#, no-wrap
msgid "`mpo_create_ifnet`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2672
#, no-wrap
msgid ""
"void mpo_create_ifnet(\tifnet,\n"
" \tifnetlabel);\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2682
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2881
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2965
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3018
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3150
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3460
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4134
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5723
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5772
#, no-wrap
msgid "`ifnet`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2683
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2882
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2966
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3019
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5724
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5773
#, no-wrap
msgid "Network interface"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2686
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2885
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2969
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3022
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3154
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3464
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4138
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5727
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5776
#, no-wrap
msgid "`ifnetlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2687
#, no-wrap
msgid "Policy label to fill in for `ifnet`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2692
msgid ""
"Set the label on a newly created interface.  This call may be made when a "
"new physical interface becomes available to the system, or when a pseudo-"
"interface is instantiated during the boot or as a result of a user action."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2694
#, no-wrap
msgid "`mpo_create_ipq`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2706
#, no-wrap
msgid ""
"void mpo_create_ipq(\tfragment,\n"
" \tfragmentlabel,\n"
" \tipq,\n"
" \tipqlabel);\n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2716
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2806
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3102
#, no-wrap
msgid "`fragment`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2717
#, no-wrap
msgid "First received IP fragment"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2720
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2810
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3106
#, no-wrap
msgid "`fragmentlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2721
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3107
#, no-wrap
msgid "Policy label for `fragment`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2724
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2757
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3110
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3195
#, no-wrap
msgid "`ipq`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2725
#, no-wrap
msgid "IP reassembly queue to be labeled"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2728
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2761
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3114
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3199
#, no-wrap
msgid "`ipqlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2729
#, no-wrap
msgid "Policy label to be filled in for `ipq`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2733
msgid ""
"Set the label on a newly created IP fragment reassembly queue from the mbuf "
"header of the first received fragment."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2735
#, no-wrap
msgid "`mpo_create_datagram_from_ipq`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2747
#, no-wrap
msgid ""
"void mpo_create_create_datagram_from_ipq(\tipq,\n"
" \tipqlabel,\n"
" \tdatagram,\n"
" \tdatagramlabel);\n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
"struct mbuf *datagram;\n"
"struct label *datagramlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2758
#, no-wrap
msgid "IP reassembly queue"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2762
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3115
#, no-wrap
msgid "Policy label for `ipq`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2765
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2798
#, no-wrap
msgid "`datagram`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2766
#, no-wrap
msgid "Datagram to be labeled"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2769
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2802
#, no-wrap
msgid "`datagramlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2770
#, no-wrap
msgid "Policy label to be filled in for `datagramlabel`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2774
msgid ""
"Set the label on a newly reassembled IP datagram from the IP fragment "
"reassembly queue from which it was generated."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2776
#, no-wrap
msgid "`mpo_create_fragment`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2788
#, no-wrap
msgid ""
"void mpo_create_fragment(\tdatagram,\n"
" \tdatagramlabel,\n"
" \tfragment,\n"
" \tfragmentlabel);\n"
"struct mbuf *datagram;\n"
"struct label *datagramlabel;\n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2799
#, no-wrap
msgid "Datagram"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2803
#, no-wrap
msgid "Policy label for `datagram`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2807
#, no-wrap
msgid "Fragment to be labeled"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2811
#, no-wrap
msgid "Policy label to be filled in for `datagram`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2815
msgid ""
"Set the label on the mbuf header of a newly created IP fragment from the "
"label on the mbuf header of the datagram it was generate from."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2817
#, no-wrap
msgid "`mpo_create_mbuf_from_mbuf`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2829
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_mbuf(\toldmbuf,\n"
" \toldmbuflabel,\n"
" \tnewmbuf,\n"
" \tnewmbuflabel);\n"
"struct mbuf *oldmbuf;\n"
"struct label *oldmbuflabel;\n"
"struct mbuf *newmbuf;\n"
"struct label *newmbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2839
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3010
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3060
#, no-wrap
msgid "`oldmbuf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2840
#, no-wrap
msgid "Existing (source) mbuf"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2843
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3014
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3064
#, no-wrap
msgid "`oldmbuflabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2844
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3015
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3065
#, no-wrap
msgid "Policy label for `oldmbuf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2847
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3026
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3068
#, no-wrap
msgid "`newmbuf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2848
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2932
#, no-wrap
msgid "New mbuf to be labeled"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2851
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3030
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3072
#, no-wrap
msgid "`newmbuflabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2852
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3031
#, no-wrap
msgid "Policy label to be filled in for `newmbuf`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2857
msgid ""
"Set the label on the mbuf header of a newly created datagram from the mbuf "
"header of an existing datagram.  This call may be made in a number of "
"situations, including when an mbuf is re-allocated for alignment purposes."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2859
#, no-wrap
msgid "`mpo_create_mbuf_linklayer`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2871
#, no-wrap
msgid ""
"void mpo_create_mbuf_linklayer(\tifnet,\n"
" \tifnetlabel,\n"
" \tmbuf,\n"
" \tmbuflabel);\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2886
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3023
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3155
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3465
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5728
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5777
#, no-wrap
msgid "Policy label for `ifnet`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2890
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2974
#, no-wrap
msgid "mbuf header for new datagram"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2894
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2978
#, no-wrap
msgid "Policy label to be filled in for `mbuf`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2899
msgid ""
"Set the label on the mbuf header of a newly created datagram generated for "
"the purposes of a link layer response for the passed interface.  This call "
"may be made in a number of situations, including for ARP or ND6 responses in "
"the IPv4 and IPv6 stacks."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2901
#, no-wrap
msgid "`mpo_create_mbuf_from_bpfdesc`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2913
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_bpfdesc(\tbpf_d,\n"
" \tbpflabel,\n"
" \tmbuf,\n"
" \tmbuflabel);\n"
"struct bpf_d *bpf_d;\n"
"struct label *bpflabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2924
#, no-wrap
msgid "BPF descriptor"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2927
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3456
#, no-wrap
msgid "`bpflabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2928
#, no-wrap
msgid "Policy label for `bpflabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2936
#, no-wrap
msgid "Policy label to fill in for `mbuf`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2941
msgid ""
"Set the label on the mbuf header of a newly created datagram generated using "
"the passed BPF descriptor.  This call is made when a write is performed to "
"the BPF device associated with the passed BPF descriptor."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2943
#, no-wrap
msgid "`mpo_create_mbuf_from_ifnet`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2955
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_ifnet(\tifnet,\n"
" \tifnetlabel,\n"
" \tmbuf,\n"
" \tmbuflabel);\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2970
#, no-wrap
msgid "Policy label for `ifnetlabel`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2982
msgid ""
"Set the label on the mbuf header of a newly created datagram generated from "
"the passed network interface."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:2984
#, no-wrap
msgid "`mpo_create_mbuf_multicast_encap`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3000
#, no-wrap
msgid ""
"void mpo_create_mbuf_multicast_encap(\toldmbuf,\n"
" \toldmbuflabel,\n"
" \tifnet,\n"
" \tifnetlabel,\n"
" \tnewmbuf,\n"
" \tnewmbuflabel);\n"
"struct mbuf *oldmbuf;\n"
"struct label *oldmbuflabel;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *newmbuf;\n"
"struct label *newmbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3011
#, no-wrap
msgid "mbuf header for existing datagram"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3027
#, no-wrap
msgid "mbuf header to be labeled for new datagram"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3036
msgid ""
"Set the label on the mbuf header of a newly created datagram generated from "
"the existing passed datagram when it is processed by the passed multicast "
"encapsulation interface.  This call is made when an mbuf is to be delivered "
"using the virtual interface."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3038
#, no-wrap
msgid "`mpo_create_mbuf_netlayer`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3050
#, no-wrap
msgid ""
"void mpo_create_mbuf_netlayer(\toldmbuf,\n"
" \toldmbuflabel,\n"
" \tnewmbuf,\n"
" \tnewmbuflabel);\n"
"struct mbuf *oldmbuf;\n"
"struct label *oldmbuflabel;\n"
"struct mbuf *newmbuf;\n"
"struct label *newmbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3061
#, no-wrap
msgid "Received datagram"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3069
#, no-wrap
msgid "Newly created datagram"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3073
#, no-wrap
msgid "Policy label for `newmbuf`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3078
msgid ""
"Set the label on the mbuf header of a newly created datagram generated by "
"the IP stack in response to an existing received datagram (`oldmbuf`).  This "
"call may be made in a number of situations, including when responding to "
"ICMP request datagrams."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3080
#, no-wrap
msgid "`mpo_fragment_match`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3092
#, no-wrap
msgid ""
"int mpo_fragment_match(\tfragment,\n"
" \tfragmentlabel,\n"
" \tipq,\n"
" \tipqlabel);\n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3103
#, no-wrap
msgid "IP datagram fragment"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3111
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3196
#, no-wrap
msgid "IP fragment reassembly queue"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3122
msgid ""
"Determine whether an mbuf header containing an IP datagram (`fragment`) "
"fragment matches the label of the passed IP fragment reassembly queue "
"(`ipq`).  Return (1) for a successful match, or (0) for no match.  This call "
"is made when the IP stack attempts to find an existing fragment reassembly "
"queue for a newly received fragment; if this fails, a new fragment "
"reassembly queue may be instantiated for the fragment.  Policies may use "
"this entry point to prevent the reassembly of otherwise matching IP "
"fragments if policy does not permit them to be reassembled based on the "
"label or other information."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3124
#, no-wrap
msgid "`mpo_relabel_ifnet`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3136
#, no-wrap
msgid ""
"void mpo_relabel_ifnet(\tcred,\n"
" \tifnet,\n"
" \tifnetlabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3151
#, no-wrap
msgid "Object; Network interface"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3159
#, no-wrap
msgid "Label update to apply to `ifnet`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3163
msgid ""
"Update the label of network interface, `ifnet`, based on the passed update "
"label, `newlabel`, and the passed subject credential, `cred`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3165
#, no-wrap
msgid "`mpo_update_ipq`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3177
#, no-wrap
msgid ""
"void mpo_update_ipq(\tfragment,\n"
" \tfragmentlabel,\n"
" \tipq,\n"
" \tipqlabel);\n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3188
#, no-wrap
msgid "IP fragment"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3192
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5736
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5785
#, no-wrap
msgid "Policy label for `mbuf`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3200
#, no-wrap
msgid "Policy label to be updated for `ipq`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3204
msgid ""
"Update the label on an IP fragment reassembly queue (`ipq`) based on the "
"acceptance of the passed IP fragment mbuf header (`mbuf`)."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3206
#, no-wrap
msgid "Process Labeling Event Operations"
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3209
#, no-wrap
msgid "`mpo_create_cred`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3217
#, no-wrap
msgid ""
"void mpo_create_cred(\tparent_cred,\n"
" \tchild_cred);\n"
"struct ucred *parent_cred;\n"
"struct ucred *child_cred;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3227
#, no-wrap
msgid "`parent_cred`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3228
#, no-wrap
msgid "Parent subject credential"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3231
#, no-wrap
msgid "`child_cred`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3232
#, no-wrap
msgid "Child subject credential"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3238
msgid ""
"Set the label of a newly created subject credential from the passed subject "
"credential.  This call will be made when man:crcopy[9] is invoked on a newly "
"created `struct ucred`.  This call should not be confused with a process "
"forking or creation event."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3240
#, no-wrap
msgid "`mpo_execve_transition`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3252
#, no-wrap
msgid ""
"void mpo_execve_transition(\told,\n"
" \tnew,\n"
" \tvp,\n"
" \tvnodelabel);\n"
"struct ucred *old;\n"
"struct ucred *new;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3263
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3305
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6017
#, no-wrap
msgid "`old`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3264
#, no-wrap
msgid "Existing subject credential"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3267
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6029
#, no-wrap
msgid "`new`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3268
#, no-wrap
msgid "New subject credential to be labeled"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3272
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3310
#, no-wrap
msgid "File to execute"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3283
msgid ""
"Update the label of a newly created subject credential (`new`) from the "
"passed existing subject credential (`old`) based on a label transition "
"caused by executing the passed vnode (`vp`).  This call occurs when a "
"process executes the passed vnode and one of the policies returns a success "
"from the `mpo_execve_will_transition` entry point.  Policies may choose to "
"implement this call simply by invoking `mpo_create_cred` and passing the two "
"subject credentials so as not to implement a transitioning event.  Policies "
"should not leave this entry point unimplemented if they implement "
"`mpo_create_cred`, even if they do not implement "
"`mpo_execve_will_transition`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3285
#, no-wrap
msgid "`mpo_execve_will_transition`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3295
#, no-wrap
msgid ""
"int mpo_execve_will_transition(\told,\n"
" \tvp,\n"
" \tvnodelabel);\n"
"struct ucred *old;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3306
#, no-wrap
msgid "Subject credential prior to man:execve[2]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3320
msgid ""
"Determine whether the policy will want to perform a transition event as a "
"result of the execution of the passed vnode by the passed subject "
"credential.  Return 1 if a transition is required, 0 if not.  Even if a "
"policy returns 0, it should behave correctly in the presence of an "
"unexpected invocation of `mpo_execve_transition`, as that call may happen as "
"a result of another policy requesting a transition."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3322
#, no-wrap
msgid "`mpo_create_proc0`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3328
#, no-wrap
msgid ""
"void mpo_create_proc0(\tcred);\n"
"struct ucred *cred;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3339
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3362
#, no-wrap
msgid "Subject credential to be filled in"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3343
msgid ""
"Create the subject credential of process 0, the parent of all kernel "
"processes."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3345
#, no-wrap
msgid "`mpo_create_proc1`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3351
#, no-wrap
msgid ""
"void mpo_create_proc1(\tcred);\n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3366
msgid ""
"Create the subject credential of process 1, the parent of all user processes."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3368
#, no-wrap
msgid "`mpo_relabel_cred`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3376
#, no-wrap
msgid ""
"void mpo_relabel_cred(\tcred,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3391
#, no-wrap
msgid "Label update to apply to `cred`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3395
msgid "Update the label on a subject credential from the passed update label."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3397
#, no-wrap
msgid "Access Control Checks"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3405
msgid ""
"Access control entry points permit policy modules to influence access "
"control decisions made by the kernel.  Generally, although not always, "
"arguments to an access control entry point will include one or more "
"authorizing credentials, information (possibly including a label) for any "
"other objects involved in the operation.  An access control entry point may "
"return 0 to permit the operation, or an man:errno[2] error value.  The "
"results of invoking the entry point across various registered policy modules "
"will be composed as follows: if all modules permit the operation to succeed, "
"success will be returned.  If one or modules returns a failure, a failure "
"will be returned.  If more than one module returns a failure, the errno "
"value to return to the user will be selected using the following precedence, "
"implemented by the `error_select()` function in [.filename]#kern_mac.c#:"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3411
#, no-wrap
msgid "Most precedence"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3413
#, no-wrap
msgid "EDEADLK"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3416
#, no-wrap
msgid "EINVAL"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3419
#, no-wrap
msgid "ESRCH"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3422
#, no-wrap
msgid "EACCES"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3423
#, no-wrap
msgid "Least precedence"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3424
#, no-wrap
msgid "EPERM"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3428
msgid ""
"If none of the error values returned by all modules are listed in the "
"precedence chart then an arbitrarily selected value from the set will be "
"returned.  In general, the rules provide precedence to errors in the "
"following order: kernel failures, invalid arguments, object not present, "
"access not permitted, other."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3430
#, no-wrap
msgid "`mpo_check_bpfdesc_receive`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3442
#, no-wrap
msgid ""
"int mpo_check_bpfdesc_receive(\tbpf_d,\n"
" \tbpflabel,\n"
" \tifnet,\n"
" \tifnetlabel);\n"
"struct bpf_d *bpf_d;\n"
"struct label *bpflabel;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3453
#, no-wrap
msgid "Subject; BPF descriptor"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3457
#, no-wrap
msgid "Policy label for `bpf_d`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3461
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4135
#, no-wrap
msgid "Object; network interface"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3470
msgid ""
"Determine whether the MAC framework should permit datagrams from the passed "
"interface to be delivered to the buffers of the passed BPF descriptor.  "
"Return (0) for success, or an `errno` value for failure Suggested failure: "
"EACCES for label mismatches, EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3472
#, no-wrap
msgid "`mpo_check_kenv_dump`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3478
#, no-wrap
msgid ""
"int mpo_check_kenv_dump(\tcred);\n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3493
msgid ""
"Determine whether the subject should be allowed to retrieve the kernel "
"environment (see man:kenv[2])."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3495
#, no-wrap
msgid "`mpo_check_kenv_get`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3503
#, no-wrap
msgid ""
"int mpo_check_kenv_get(\tcred,\n"
" \tname);\n"
"struct ucred *cred;\n"
"char *name;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3517
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3546
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3575
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4719
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5385
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6009
#, no-wrap
msgid "`name`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3518
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3547
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3576
#, no-wrap
msgid "Kernel environment variable name"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3522
msgid ""
"Determine whether the subject should be allowed to retrieve the value of the "
"specified kernel environment variable."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3524
#, no-wrap
msgid "`mpo_check_kenv_set`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3532
#, no-wrap
msgid ""
"int mpo_check_kenv_set(\tcred,\n"
" \tname);\n"
"struct ucred *cred;\n"
"char *name;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3551
msgid ""
"Determine whether the subject should be allowed to set the specified kernel "
"environment variable."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3553
#, no-wrap
msgid "`mpo_check_kenv_unset`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3561
#, no-wrap
msgid ""
"int mpo_check_kenv_unset(\tcred,\n"
" \tname);\n"
"struct ucred *cred;\n"
"char *name;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3580
msgid ""
"Determine whether the subject should be allowed to unset the specified "
"kernel environment variable."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3582
#, no-wrap
msgid "`mpo_check_kld_load`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3592
#, no-wrap
msgid ""
"int mpo_check_kld_load(\tcred,\n"
" \tvp,\n"
" \tvlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3607
#, no-wrap
msgid "Kernel module vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3611
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5859
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5969
#, no-wrap
msgid "Label associated with `vp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3615
msgid ""
"Determine whether the subject should be allowed to load the specified module "
"file."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3617
#, no-wrap
msgid "`mpo_check_kld_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3623
#, no-wrap
msgid ""
"int mpo_check_kld_stat(\tcred);\n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3638
msgid ""
"Determine whether the subject should be allowed to retrieve a list of loaded "
"kernel module files and associated statistics."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3640
#, no-wrap
msgid "`mpo_check_kld_unload`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3646
#, no-wrap
msgid ""
"int mpo_check_kld_unload(\tcred);\n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3661
msgid ""
"Determine whether the subject should be allowed to unload a kernel module."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3663
#, no-wrap
msgid "`mpo_check_pipe_ioctl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3677
#, no-wrap
msgid ""
"int mpo_check_pipe_ioctl(\tcred,\n"
" \tpipe,\n"
" \tpipelabel,\n"
" \tcmd,\n"
" \tdata);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
"unsigned long cmd;\n"
"void *data;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3699
#, no-wrap
msgid "`cmd`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3700
#, no-wrap
msgid "man:ioctl[2] command"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3703
#, no-wrap
msgid "`data`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3704
#, no-wrap
msgid "man:ioctl[2] data"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3708
msgid ""
"Determine whether the subject should be allowed to make the specified man:"
"ioctl[2] call."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3710
#, no-wrap
msgid "`mpo_check_pipe_poll`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3720
#, no-wrap
msgid ""
"int mpo_check_pipe_poll(\tcred,\n"
" \tpipe,\n"
" \tpipelabel);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3743
msgid "Determine whether the subject should be allowed to poll `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3745
#, no-wrap
msgid "`mpo_check_pipe_read`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3755
#, no-wrap
msgid ""
"int mpo_check_pipe_read(\tcred,\n"
" \tpipe,\n"
" \tpipelabel);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3778
msgid "Determine whether the subject should be allowed read access to `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3780
#, no-wrap
msgid "`mpo_check_pipe_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3792
#, no-wrap
msgid ""
"int mpo_check_pipe_relabel(\tcred,\n"
" \tpipe,\n"
" \tpipelabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3815
#, no-wrap
msgid "Label update to `pipelabel`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3819
msgid "Determine whether the subject should be allowed to relabel `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3821
#, no-wrap
msgid "`mpo_check_pipe_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3831
#, no-wrap
msgid ""
"int mpo_check_pipe_stat(\tcred,\n"
" \tpipe,\n"
" \tpipelabel);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3854
msgid ""
"Determine whether the subject should be allowed to retrieve statistics "
"related to `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3856
#, no-wrap
msgid "`mpo_check_pipe_write`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3866
#, no-wrap
msgid ""
"int mpo_check_pipe_write(\tcred,\n"
" \tpipe,\n"
" \tpipelabel);\n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3889
msgid "Determine whether the subject should be allowed to write to `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3891
#, no-wrap
msgid "`mpo_check_socket_bind`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3903
#, no-wrap
msgid ""
"int mpo_check_socket_bind(\tcred,\n"
" \tsocket,\n"
" \tsocketlabel,\n"
" \tsockaddr);\n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
"struct sockaddr *sockaddr;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3918
#, no-wrap
msgid "Socket to be bound"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3925
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3964
#, no-wrap
msgid "`sockaddr`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3926
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3965
#, no-wrap
msgid "Address of `socket`"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3930
#, no-wrap
msgid "`mpo_check_socket_connect`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3942
#, no-wrap
msgid ""
"int mpo_check_socket_connect(\tcred,\n"
" \tsocket,\n"
" \tsocketlabel,\n"
" \tsockaddr);\n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
"struct sockaddr *sockaddr;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3957
#, no-wrap
msgid "Socket to be connected"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3971
msgid ""
"Determine whether the subject credential (`cred`) can connect the passed "
"socket (`socket`) to the passed socket address (`sockaddr`).  Return 0 for "
"success, or an `errno` value for failure.  Suggested failure: EACCES for "
"label mismatches, EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3973
#, no-wrap
msgid "`mpo_check_socket_receive`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:3983
#, no-wrap
msgid ""
"int mpo_check_socket_receive(\tcred,\n"
" \tso,\n"
" \tsocketlabel);\n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4002
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4037
#, no-wrap
msgid "Policy label associated with `so`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4006
msgid ""
"Determine whether the subject should be allowed to receive information from "
"the socket `so`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4008
#, no-wrap
msgid "`mpo_check_socket_send`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4018
#, no-wrap
msgid ""
"int mpo_check_socket_send(\tcred,\n"
" \tso,\n"
" \tsocketlabel);\n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4041
msgid ""
"Determine whether the subject should be allowed to send information across "
"the socket `so`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4043
#, no-wrap
msgid "`mpo_check_cred_visible`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4051
#, no-wrap
msgid ""
"int mpo_check_cred_visible(\tu1,\n"
" \tu2);\n"
"struct ucred *u1;\n"
"struct ucred *u2;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4061
#, no-wrap
msgid "`u1`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4065
#, no-wrap
msgid "`u2`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4066
#, no-wrap
msgid "Object credential"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4073
msgid ""
"Determine whether the subject credential `u1` can \"see\" other subjects "
"with the passed subject credential `u2`.  Return 0 for success, or an "
"`errno` value for failure.  Suggested failure: EACCES for label mismatches, "
"EPERM for lack of privilege, or ESRCH to hide visibility.  This call may be "
"made in a number of situations, including inter-process status sysctl's used "
"by `ps`, and in procfs lookups."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4075
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5793
#, no-wrap
msgid "`mpo_check_socket_visible`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4085
#, no-wrap
msgid ""
"int mpo_check_socket_visible(\tcred,\n"
" \tsocket,\n"
" \tsocketlabel);\n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4108
#, no-wrap
msgid "`mpo_check_ifnet_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4120
#, no-wrap
msgid ""
"int mpo_check_ifnet_relabel(\tcred,\n"
" \tifnet,\n"
" \tifnetlabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4139
#, no-wrap
msgid "Existing policy label for `ifnet`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4143
#, no-wrap
msgid "Policy label update to later be applied to `ifnet`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4147
msgid ""
"Determine whether the subject credential can relabel the passed network "
"interface to the passed label update."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4149
#, no-wrap
msgid "`mpo_check_socket_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4161
#, no-wrap
msgid ""
"int mpo_check_socket_relabel(\tcred,\n"
" \tsocket,\n"
" \tsocketlabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4180
#, no-wrap
msgid "Existing policy label for `socket`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4184
#, no-wrap
msgid "Label update to later be applied to `socketlabel`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4188
msgid ""
"Determine whether the subject credential can relabel the passed socket to "
"the passed label update."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4190
#, no-wrap
msgid "`mpo_check_cred_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4198
#, no-wrap
msgid ""
"int mpo_check_cred_relabel(\tcred,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4213
#, no-wrap
msgid "Label update to later be applied to `cred`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4217
msgid ""
"Determine whether the subject credential can relabel itself to the passed "
"label update."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4219
#, no-wrap
msgid "`mpo_check_vnode_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4231
#, no-wrap
msgid ""
"int mpo_check_vnode_relabel(\tcred,\n"
" \tvp,\n"
" \tvnodelabel,\n"
" \tnewlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4246
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4357
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4475
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4580
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4661
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4708
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5123
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5166
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5244
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5282
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5323
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5374
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5428
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5471
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5516
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5681
#, no-wrap
msgid "Object; vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4254
#, no-wrap
msgid "Policy label update to later be applied to `vp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4258
msgid ""
"Determine whether the subject credential can relabel the passed vnode to the "
"passed label update."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4260
#, no-wrap
msgid "`mpo_check_mount_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4270
#, no-wrap
msgid ""
"int mpo_check_mount_stat(\tcred,\n"
" \tmp,\n"
" \tmountlabel);\n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *mountlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4285
#, no-wrap
msgid "Object; file system mount"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4288
#, no-wrap
msgid "`mountlabel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4289
#, no-wrap
msgid "Policy label for `mp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4296
msgid ""
"Determine whether the subject credential can see the results of a statfs "
"performed on the file system.  Return 0 for success, or an `errno` value for "
"failure.  Suggested failure: EACCES for label mismatches or EPERM for lack "
"of privilege.  This call may be made in a number of situations, including "
"during invocations of man:statfs[2] and related calls, as well as to "
"determine what file systems to exclude from listings of file systems, such "
"as when man:getfsstat[2] is invoked."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4298
#, no-wrap
msgid "`mpo_check_proc_debug`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4306
#, no-wrap
msgid ""
"int mpo_check_proc_debug(\tcred,\n"
" \tproc);\n"
"struct ucred *cred;\n"
"struct proc *proc;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4320
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5608
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5643
#, no-wrap
msgid "`proc`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4321
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5609
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5644
#, no-wrap
msgid "Object; process"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4328
msgid ""
"Determine whether the subject credential can debug the passed process.  "
"Return 0 for success, or an `errno` value for failure.  Suggested failure: "
"EACCES for label mismatch, EPERM for lack of privilege, or ESRCH to hide "
"visibility of the target.  This call may be made in a number of situations, "
"including use of the man:ptrace[2] and man:ktrace[2] APIs, as well as for "
"some types of procfs operations."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4330
#, no-wrap
msgid "`mpo_check_vnode_access`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4342
#, no-wrap
msgid ""
"int mpo_check_vnode_access(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tflags);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int flags;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4364
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5435
#, no-wrap
msgid "`flags`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4365
#, no-wrap
msgid "man:access[2] flags"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4372
msgid ""
"Determine how invocations of man:access[2] and related calls by the subject "
"credential should return when performed on the passed vnode using the passed "
"access flags.  This should generally be implemented using the same semantics "
"used in `mpo_check_vnode_open`.  Return 0 for success, or an `errno` value "
"for failure.  Suggested failure: EACCES for label mismatches or EPERM for "
"lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4374
#, no-wrap
msgid "`mpo_check_vnode_chdir`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4384
#, no-wrap
msgid ""
"int mpo_check_vnode_chdir(\tcred,\n"
" \tdvp,\n"
" \tdlabel);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4399
#, no-wrap
msgid "Object; vnode to man:chdir[2] into"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4403
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4479
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4531
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5127
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5211
#, no-wrap
msgid "Policy label for `dvp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4409
msgid ""
"Determine whether the subject credential can change the process working "
"directory to the passed vnode.  Return 0 for success, or an `errno` value "
"for failure.  Suggested failure: EACCES for label mismatch, or EPERM for "
"lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4411
#, no-wrap
msgid "`mpo_check_vnode_chroot`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4421
#, no-wrap
msgid ""
"int mpo_check_vnode_chroot(\tcred,\n"
" \tdvp,\n"
" \tdlabel);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4436
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4764
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4977
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5032
#, no-wrap
msgid "Directory vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4440
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4768
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4981
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5036
#, no-wrap
msgid "Policy label associated with `dvp`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4444
msgid ""
"Determine whether the subject should be allowed to man:chroot[2] into the "
"specified directory (`dvp`)."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4446
#, no-wrap
msgid "`mpo_check_vnode_create`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4460
#, no-wrap
msgid ""
"int mpo_check_vnode_create(\tcred,\n"
" \tdvp,\n"
" \tdlabel,\n"
" \tcnp,\n"
" \tvap);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct componentname *cnp;\n"
"struct vattr *vap;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4483
#, no-wrap
msgid "Component name for `dvp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4486
#, no-wrap
msgid "`vap`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4487
#, no-wrap
msgid "vnode attributes for `vap`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4494
msgid ""
"Determine whether the subject credential can create a vnode with the passed "
"parent directory, passed name information, and passed attribute "
"information.  Return 0 for success, or an `errno` value for failure.  "
"Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege.  This call may be made in a number of situations, including as a "
"result of calls to man:open[2] with O_CREAT, man:mkfifo[2], and others."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4496
#, no-wrap
msgid "`mpo_check_vnode_delete`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4512
#, no-wrap
msgid ""
"int mpo_check_vnode_delete(\tcred,\n"
" \tdvp,\n"
" \tdlabel,\n"
" \tvp,\n"
" \tlabel,\n"
" \tcnp);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"void *label;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4535
#, no-wrap
msgid "Object; vnode to delete"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4551
msgid ""
"Determine whether the subject credential can delete a vnode from the passed "
"parent directory and passed name information.  Return 0 for success, or an "
"`errno` value for failure.  Suggested failure: EACCES for label mismatch, or "
"EPERM for lack of privilege.  This call may be made in a number of "
"situations, including as a result of calls to man:unlink[2] and man:"
"rmdir[2].  Policies implementing this entry point should also implement "
"`mpo_check_rename_to` to authorize deletion of objects as a result of being "
"the target of a rename."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4553
#, no-wrap
msgid "`mpo_check_vnode_deleteacl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4565
#, no-wrap
msgid ""
"int mpo_check_vnode_deleteacl(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \ttype);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"acl_type_t type;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4587
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4668
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5330
#, no-wrap
msgid "`type`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4588
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4669
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5331
#, no-wrap
msgid "ACL type"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4594
msgid ""
"Determine whether the subject credential can delete the ACL of passed type "
"from the passed vnode.  Return 0 for success, or an `errno` value for "
"failure.  Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4596
#, no-wrap
msgid "`mpo_check_vnode_exec`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4606
#, no-wrap
msgid ""
"int mpo_check_vnode_exec(\tcred,\n"
" \tvp,\n"
" \tlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4621
#, no-wrap
msgid "Object; vnode to execute"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4632
msgid ""
"Determine whether the subject credential can execute the passed vnode.  "
"Determination of execute privilege is made separately from decisions about "
"any transitioning event.  Return 0 for success, or an `errno` value for "
"failure.  Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4634
#, no-wrap
msgid "`mpo_check_vnode_getacl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4646
#, no-wrap
msgid ""
"int mpo_check_vnode_getacl(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \ttype);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"acl_type_t type;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4675
msgid ""
"Determine whether the subject credential can retrieve the ACL of passed type "
"from the passed vnode.  Return 0 for success, or an `errno` value for "
"failure.  Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4677
#, no-wrap
msgid "`mpo_check_vnode_getextattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4693
#, no-wrap
msgid ""
"int mpo_check_vnode_getextattr(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tattrnamespace,\n"
" \tname,\n"
" \tuio);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int attrnamespace;\n"
"const char *name;\n"
"struct uio *uio;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4715
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5381
#, no-wrap
msgid "`attrnamespace`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4716
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5382
#, no-wrap
msgid "Extended attribute namespace"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4720
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5386
#, no-wrap
msgid "Extended attribute name"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4723
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5389
#, no-wrap
msgid "`uio`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4724
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5390
#, no-wrap
msgid "I/O structure pointer; see man:uio[9]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4731
msgid ""
"Determine whether the subject credential can retrieve the extended attribute "
"with the passed namespace and name from the passed vnode.  Policies "
"implementing labeling using extended attributes may be interested in special "
"handling of operations on those extended attributes.  Return 0 for success, "
"or an `errno` value for failure.  Suggested failure: EACCES for label "
"mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4733
#, no-wrap
msgid "`mpo_check_vnode_link`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4749
#, no-wrap
msgid ""
"int mpo_check_vnode_link(\tcred,\n"
" \tdvp,\n"
" \tdlabel,\n"
" \tvp,\n"
" \tlabel,\n"
" \tcnp);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4772
#, no-wrap
msgid "Link destination vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4780
#, no-wrap
msgid "Component name for the link being created"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4784
msgid ""
"Determine whether the subject should be allowed to create a link to the "
"vnode `vp` with the name specified by `cnp`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4786
#, no-wrap
msgid "`mpo_check_vnode_mmap`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4798
#, no-wrap
msgid ""
"int mpo_check_vnode_mmap(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tprot);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int prot;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4813
#, no-wrap
msgid "Vnode to map"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4820
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4861
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4898
#, no-wrap
msgid "`prot`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4821
#, no-wrap
msgid "Mmap protections (see man:mmap[2])"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4825
msgid ""
"Determine whether the subject should be allowed to map the vnode `vp` with "
"the protections specified in `prot`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4827
#, no-wrap
msgid "`mpo_check_vnode_mmap_downgrade`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4839
#, no-wrap
msgid ""
"void mpo_check_vnode_mmap_downgrade(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tprot);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int *prot;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4850
#, no-wrap
msgid "See <<mac-mpo-check-vnode-mmap>>."
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4862
#, no-wrap
msgid "Mmap protections to be downgraded"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4866
msgid "Downgrade the mmap protections based on the subject and object labels."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4868
#, no-wrap
msgid "`mpo_check_vnode_mprotect`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4880
#, no-wrap
msgid ""
"int mpo_check_vnode_mprotect(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tprot);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int prot;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4895
#, no-wrap
msgid "Mapped vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4899
#, no-wrap
msgid "Memory protections"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4903
msgid ""
"Determine whether the subject should be allowed to set the specified memory "
"protections on memory mapped from the vnode `vp`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4905
#, no-wrap
msgid "`mpo_check_vnode_poll`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4917
#, no-wrap
msgid ""
"int mpo_check_vnode_poll(\tactive_cred,\n"
" \tfile_cred,\n"
" \tvp,\n"
" \tlabel);\n"
"struct ucred *active_cred;\n"
"struct ucred *file_cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4927
#, no-wrap
msgid "`active_cred`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4931
#, no-wrap
msgid "`file_cred`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4932
#, no-wrap
msgid "Credential associated with the struct file"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4936
#, no-wrap
msgid "Polled vnode"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4944
msgid "Determine whether the subject should be allowed to poll the vnode `vp`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4946
#, no-wrap
msgid "`mpo_check_vnode_rename_from`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4962
#, no-wrap
msgid ""
"int mpo_vnode_rename_from(\tcred,\n"
" \tdvp,\n"
" \tdlabel,\n"
" \tvp,\n"
" \tlabel,\n"
" \tcnp);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4985
#, no-wrap
msgid "Vnode to be renamed"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4997
msgid ""
"Determine whether the subject should be allowed to rename the vnode `vp` to "
"something else."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:4999
#, no-wrap
msgid "`mpo_check_vnode_rename_to`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5017
#, no-wrap
msgid ""
"int mpo_check_vnode_rename_to(\tcred,\n"
" \tdvp,\n"
" \tdlabel,\n"
" \tvp,\n"
" \tlabel,\n"
" \tsamedir,\n"
" \tcnp);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int samedir;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5040
#, no-wrap
msgid "Overwritten vnode"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5047
#, no-wrap
msgid "`samedir`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5048
#, no-wrap
msgid "Boolean; `1` if the source and destination directories are the same"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5052
#, no-wrap
msgid "Destination component name"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5057
msgid ""
"Determine whether the subject should be allowed to rename to the vnode `vp`, "
"into the directory `dvp`, or to the name represented by `cnp`.  If there is "
"no existing file to overwrite, `vp` and `label` will be NULL."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5059
#, no-wrap
msgid "`mpo_check_socket_listen`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5069
#, no-wrap
msgid ""
"int mpo_check_socket_listen(\tcred,\n"
" \tsocket,\n"
" \tsocketlabel);\n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5094
msgid ""
"Determine whether the subject credential can listen on the passed socket.  "
"Return 0 for success, or an `errno` value for failure.  Suggested failure: "
"EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5096
#, no-wrap
msgid "`mpo_check_vnode_lookup`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5108
#, no-wrap
msgid ""
"int mpo_check_vnode_lookup(\t,\n"
" \t,\n"
" \t,\n"
" \tcnp);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5131
#, no-wrap
msgid "Component name being looked up"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5137
msgid ""
"Determine whether the subject credential can perform a lookup in the passed "
"directory vnode for the passed name.  Return 0 for success, or an `errno` "
"value for failure.  Suggested failure: EACCES for label mismatch, or EPERM "
"for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5139
#, no-wrap
msgid "`mpo_check_vnode_open`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5151
#, no-wrap
msgid ""
"int mpo_check_vnode_open(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tacc_mode);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int acc_mode;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5173
#, no-wrap
msgid "`acc_mode`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5174
#, no-wrap
msgid "man:open[2] access mode"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5180
msgid ""
"Determine whether the subject credential can perform an open operation on "
"the passed vnode with the passed access mode.  Return 0 for success, or an "
"errno value for failure.  Suggested failure: EACCES for label mismatch, or "
"EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5182
#, no-wrap
msgid "`mpo_check_vnode_readdir`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5192
#, no-wrap
msgid ""
"int mpo_check_vnode_readdir(\t,\n"
" \t,\n"
" \t);\n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5207
#, no-wrap
msgid "Object; directory vnode"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5217
msgid ""
"Determine whether the subject credential can perform a `readdir` operation "
"on the passed directory vnode.  Return 0 for success, or an `errno` value "
"for failure.  Suggested failure: EACCES for label mismatch, or EPERM for "
"lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5219
#, no-wrap
msgid "`mpo_check_vnode_readlink`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5229
#, no-wrap
msgid ""
"int mpo_check_vnode_readlink(\tcred,\n"
" \tvp,\n"
" \tlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5255
msgid ""
"Determine whether the subject credential can perform a `readlink` operation "
"on the passed symlink vnode.  Return 0 for success, or an `errno` value for "
"failure.  Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege.  This call may be made in a number of situations, including an "
"explicit `readlink` call by the user process, or as a result of an implicit "
"`readlink` during a name lookup by the process."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5257
#, no-wrap
msgid "`mpo_check_vnode_revoke`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5267
#, no-wrap
msgid ""
"int mpo_check_vnode_revoke(\tcred,\n"
" \tvp,\n"
" \tlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5292
msgid ""
"Determine whether the subject credential can revoke access to the passed "
"vnode.  Return 0 for success, or an `errno` value for failure.  Suggested "
"failure: EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5294
#, no-wrap
msgid "`mpo_check_vnode_setacl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5308
#, no-wrap
msgid ""
"int mpo_check_vnode_setacl(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \ttype,\n"
" \tacl);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"acl_type_t type;\n"
"struct acl *acl;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5334
#, no-wrap
msgid "`acl`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5335
#, no-wrap
msgid "ACL"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5341
msgid ""
"Determine whether the subject credential can set the passed ACL of passed "
"type on the passed vnode.  Return 0 for success, or an `errno` value for "
"failure.  Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5343
#, no-wrap
msgid "`mpo_check_vnode_setextattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5359
#, no-wrap
msgid ""
"int mpo_check_vnode_setextattr(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tattrnamespace,\n"
" \tname,\n"
" \tuio);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int attrnamespace;\n"
"const char *name;\n"
"struct uio *uio;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5399
msgid ""
"Determine whether the subject credential can set the extended attribute of "
"passed name and passed namespace on the passed vnode.  Policies implementing "
"security labels backed into extended attributes may want to provide "
"additional protections for those attributes.  Additionally, policies should "
"avoid making decisions based on the data referenced from `uio`, as there is "
"a potential race condition between this check and the actual operation.  The "
"`uio` may also be `NULL` if a delete operation is being performed.  Return 0 "
"for success, or an `errno` value for failure.  Suggested failure: EACCES for "
"label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5401
#, no-wrap
msgid "`mpo_check_vnode_setflags`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5413
#, no-wrap
msgid ""
"int mpo_check_vnode_setflags(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tflags);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"u_long flags;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5436
#, no-wrap
msgid "File flags; see man:chflags[2]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5442
msgid ""
"Determine whether the subject credential can set the passed flags on the "
"passed vnode.  Return 0 for success, or an `errno` value for failure.  "
"Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5444
#, no-wrap
msgid "`mpo_check_vnode_setmode`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5456
#, no-wrap
msgid ""
"int mpo_check_vnode_setmode(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tmode);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"mode_t mode;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5478
#, no-wrap
msgid "`mode`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5479
#, no-wrap
msgid "File mode; see man:chmod[2]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5485
msgid ""
"Determine whether the subject credential can set the passed mode on the "
"passed vnode.  Return 0 for success, or an `errno` value for failure.  "
"Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5487
#, no-wrap
msgid "`mpo_check_vnode_setowner`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5501
#, no-wrap
msgid ""
"int mpo_check_vnode_setowner(\tcred,\n"
" \tvp,\n"
" \tlabel,\n"
" \tuid,\n"
" \tgid);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"uid_t uid;\n"
"gid_t gid;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5523
#, no-wrap
msgid "`uid`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5524
#, no-wrap
msgid "User ID"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5527
#, no-wrap
msgid "`gid`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5528
#, no-wrap
msgid "Group ID"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5535
msgid ""
"Determine whether the subject credential can set the passed uid and passed "
"gid as file uid and file gid on the passed vnode.  The IDs may be set to "
"(`-1`) to request no update.  Return 0 for success, or an `errno` value for "
"failure.  Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5537
#, no-wrap
msgid "`mpo_check_vnode_setutimes`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5551
#, no-wrap
msgid ""
"int mpo_check_vnode_setutimes(\t,\n"
" \t,\n"
" \t,\n"
" \t,\n"
" \t);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"struct timespec atime;\n"
"struct timespec mtime;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5566
#, no-wrap
msgid "Object; vp"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5573
#, no-wrap
msgid "`atime`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5574
#, no-wrap
msgid "Access time; see man:utimes[2]"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5577
#, no-wrap
msgid "`mtime`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5578
#, no-wrap
msgid "Modification time; see man:utimes[2]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5584
msgid ""
"Determine whether the subject credential can set the passed access "
"timestamps on the passed vnode.  Return 0 for success, or an `errno` value "
"for failure.  Suggested failure: EACCES for label mismatch, or EPERM for "
"lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5586
#, no-wrap
msgid "`mpo_check_proc_sched`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5594
#, no-wrap
msgid ""
"int mpo_check_proc_sched(\tucred,\n"
" \tproc);\n"
"struct ucred *ucred;\n"
"struct proc *proc;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5615
msgid ""
"Determine whether the subject credential can change the scheduling "
"parameters of the passed process.  Return 0 for success, or an `errno` value "
"for failure.  Suggested failure: EACCES for label mismatch, EPERM for lack "
"of privilege, or ESRCH to limit visibility."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5617
msgid "See man:setpriority[2] for more information."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5619
#, no-wrap
msgid "`mpo_check_proc_signal`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5629
#, no-wrap
msgid ""
"int mpo_check_proc_signal(\tcred,\n"
" \tproc,\n"
" \tsignal);\n"
"struct ucred *cred;\n"
"struct proc *proc;\n"
"int signal;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5647
#, no-wrap
msgid "`signal`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5648
#, no-wrap
msgid "Signal; see man:kill[2]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5654
msgid ""
"Determine whether the subject credential can deliver the passed signal to "
"the passed process.  Return 0 for success, or an `errno` value for failure.  "
"Suggested failure: EACCES for label mismatch, EPERM for lack of privilege, "
"or ESRCH to limit visibility."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5656
#, no-wrap
msgid "`mpo_check_vnode_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5666
#, no-wrap
msgid ""
"int mpo_check_vnode_stat(\tcred,\n"
" \tvp,\n"
" \tlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5691
msgid ""
"Determine whether the subject credential can `stat` the passed vnode.  "
"Return 0 for success, or an `errno` value for failure.  Suggested failure: "
"EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5693
msgid "See man:stat[2] for more information."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5695
#, no-wrap
msgid "`mpo_check_ifnet_transmit`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5709
#, no-wrap
msgid ""
"int mpo_check_ifnet_transmit(\tcred,\n"
" \tifnet,\n"
" \tifnetlabel,\n"
" \tmbuf,\n"
" \tmbuflabel);\n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5732
#, no-wrap
msgid "Object; mbuf to be sent"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5742
msgid ""
"Determine whether the network interface can transmit the passed mbuf.  "
"Return 0 for success, or an `errno` value for failure.  Suggested failure: "
"EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5744
#, no-wrap
msgid "`mpo_check_socket_deliver`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5758
#, no-wrap
msgid ""
"int mpo_check_socket_deliver(\tcred,\n"
" \tifnet,\n"
" \tifnetlabel,\n"
" \tmbuf,\n"
" \tmbuflabel);\n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5781
#, no-wrap
msgid "Object; mbuf to be delivered"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5791
msgid ""
"Determine whether the socket may receive the datagram stored in the passed "
"mbuf header.  Return 0 for success, or an `errno` value for failure.  "
"Suggested failures: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5803
#, no-wrap
msgid ""
"int mpo_check_socket_visible(\tcred,\n"
" \tso,\n"
" \tsocketlabel);\n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5822
#, no-wrap
msgid "Policy label for `so`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5828
msgid ""
"Determine whether the subject credential cred can \"see\" the passed socket "
"(`socket`) using system monitoring functions, such as those employed by man:"
"netstat[8] and man:sockstat[1].  Return 0 for success, or an `errno` value "
"for failure.  Suggested failure: EACCES for label mismatches, EPERM for lack "
"of privilege, or ESRCH to hide visibility."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5830
#, no-wrap
msgid "`mpo_check_system_acct`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5840
#, no-wrap
msgid ""
"int mpo_check_system_acct(\tucred,\n"
" \tvp,\n"
" \tvlabel);\n"
"struct ucred *ucred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5850
#, no-wrap
msgid "`ucred`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5855
#, no-wrap
msgid "Accounting file; man:acct[5]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5863
msgid ""
"Determine whether the subject should be allowed to enable accounting, based "
"on its label and the label of the accounting log file."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5865
#, no-wrap
msgid "`mpo_check_system_nfsd`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5871
#, no-wrap
msgid ""
"int mpo_check_system_nfsd(\tcred);\n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5886
msgid "Determine whether the subject should be allowed to call man:nfssvc[2]."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5888
#, no-wrap
msgid "`mpo_check_system_reboot`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5896
#, no-wrap
msgid ""
"int mpo_check_system_reboot(\tcred,\n"
" \thowto);\n"
"struct ucred *cred;\n"
"int howto;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5910
#, no-wrap
msgid "`howto`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5911
#, no-wrap
msgid "`howto` parameter from man:reboot[2]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5915
msgid ""
"Determine whether the subject should be allowed to reboot the system in the "
"specified manner."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5917
#, no-wrap
msgid "`mpo_check_system_settime`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5923
#, no-wrap
msgid ""
"int mpo_check_system_settime(\tcred);\n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5938
msgid "Determine whether the user should be allowed to set the system clock."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5940
#, no-wrap
msgid "`mpo_check_system_swapon`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5950
#, no-wrap
msgid ""
"int mpo_check_system_swapon(\tcred,\n"
" \tvp,\n"
" \tvlabel);\n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5965
#, no-wrap
msgid "Swap device"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5973
msgid ""
"Determine whether the subject should be allowed to add `vp` as a swap device."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5975
#, no-wrap
msgid "`mpo_check_system_sysctl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:5995
#, no-wrap
msgid ""
"int mpo_check_system_sysctl(\tcred,\n"
" \tname,\n"
" \tnamelen,\n"
" \told,\n"
" \toldlenp,\n"
" \tinkernel,\n"
" \tnew,\n"
" \tnewlen);\n"
"struct ucred *cred;\n"
"int *name;\n"
"u_int *namelen;\n"
"void *old;\n"
"size_t *oldlenp;\n"
"int inkernel;\n"
"void *new;\n"
"size_t newlen;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6010
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6030
#, no-wrap
msgid "See man:sysctl[3]"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6021
#, no-wrap
msgid "`oldlenp`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6025
#, no-wrap
msgid "`inkernel`"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6026
#, no-wrap
msgid "Boolean; `1` if called from kernel"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6033
#, no-wrap
msgid "`newlen`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6038
msgid ""
"Determine whether the subject should be allowed to make the specified man:"
"sysctl[3] transaction."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6040
#, no-wrap
msgid "Label Management Calls"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6046
msgid ""
"Relabel events occur when a user process has requested that the label on an "
"object be modified.  A two-phase update occurs: first, an access control "
"check will be performed to determine if the update is both valid and "
"permitted, and then the update itself is performed via a separate entry "
"point.  Relabel entry points typically accept the object, object label "
"reference, and an update label submitted by the process.  Memory allocation "
"during relabel is discouraged, as relabel calls are not permitted to fail "
"(failure should be reported earlier in the relabel check)."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6048
#, no-wrap
msgid "Userland Architecture"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6052
msgid ""
"The TrustedBSD MAC Framework includes a number of policy-agnostic elements, "
"including MAC library interfaces for abstractly managing labels, "
"modifications to the system credential management and login libraries to "
"support the assignment of MAC labels to users, and a set of tools to monitor "
"and modify labels on processes, files, and network interfaces.  More details "
"on the user architecture will be added to this section in the near future."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6054
#, no-wrap
msgid "APIs for Policy-Agnostic Label Management"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6061
msgid ""
"The TrustedBSD MAC Framework provides a number of library and system calls "
"permitting applications to manage MAC labels on objects using a policy-"
"agnostic interface.  This permits applications to manipulate labels for a "
"variety of policies without being written to support specific policies.  "
"These interfaces are used by general-purpose tools such as man:ifconfig[8], "
"man:ls[1] and man:ps[1] to view labels on network interfaces, files, and "
"processes.  The APIs also support MAC management tools including man:"
"getfmac[8], man:getpmac[8], man:setfmac[8], man:setfsmac[8], and man:"
"setpmac[8].  The MAC APIs are documented in man:mac[3]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6069
msgid ""
"Applications handle MAC labels in two forms: an internalized form used to "
"return and set labels on processes and objects (`mac_t`), and externalized "
"form based on C strings appropriate for storage in configuration files, "
"display to the user, or input from the user.  Each MAC label contains a "
"number of elements, each consisting of a name and value pair.  Policy "
"modules in the kernel bind to specific names and interpret the values in "
"policy-specific ways.  In the externalized string form, labels are "
"represented by a comma-delimited list of name and value pairs separated by "
"the `/` character.  Labels may be directly converted to and from text using "
"provided APIs; when retrieving labels from the kernel, internalized label "
"storage must first be prepared for the desired label element set.  "
"Typically, this is done in one of two ways: using man:mac_prepare[3] and an "
"arbitrary list of desired label elements, or one of the variants of the call "
"that loads a default element set from the man:mac.conf[5] configuration "
"file.  Per-object defaults permit application writers to usefully display "
"labels associated with objects without being aware of the policies present "
"in the system."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6074
msgid ""
"Currently, direct manipulation of label elements other than by conversion to "
"a text string, string editing, and conversion back to an internalized label "
"is not supported by the MAC library.  Such interfaces may be added in the "
"future if they prove necessary for application writers."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6077
#, no-wrap
msgid "Binding of Labels to Users"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6081
msgid ""
"The standard user context management interface, man:setusercontext[3], has "
"been modified to retrieve MAC labels associated with a user's class from man:"
"login.conf[5].  These labels are then set along with other user context when "
"either `LOGIN_SETALL` is specified, or when `LOGIN_SETMAC` is explicitly "
"specified."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6086
msgid ""
"It is expected that, in a future version of FreeBSD, the MAC label database "
"will be separated from the [.filename]#login.conf# user class abstraction, "
"and be maintained in a separate database.  However, the man:"
"setusercontext[3] API should remain the same following such a change."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6089
#, no-wrap
msgid "Conclusion"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/_index.adoc:6094
msgid ""
"The TrustedBSD MAC framework permits kernel modules to augment the system "
"security policy in a highly integrated manner.  They may do this based on "
"existing object properties, or based on label data that is maintained with "
"the assistance of the MAC framework.  The framework is sufficiently flexible "
"to implement a variety of policy types, including information flow security "
"policies such as MLS and Biba, as well as policies based on existing BSD "
"credentials or file protections.  Policy authors may wish to consult this "
"documentation as well as existing security modules when implementing a new "
"security service."
msgstr ""
